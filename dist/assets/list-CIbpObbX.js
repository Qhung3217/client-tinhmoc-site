import{ac as K,r as u,cv as R,j as e,B as y,aX as Y,ad as F,I as h,cw as V,aZ as ee,au as te,T as j,p as se,f as re,t as W,cx as M,ap as oe,cy as ne,cz as S,h as g,cA as ae,cB as ie,w as P,e as le,cC as ce,C as O,q as de,H as ue,l as pe}from"./index-u4c5uTy0.js";import{u as xe}from"./use-debounce-CbUAKCQl.js";import{E as me}from"./empty-content-CuZPPhHf.js";import{P as he,a as ge}from"./product-skeleton-Bl_tfKYG.js";import{P as ye,p as je}from"./Pagination-D0VMOniO.js";import{M as fe}from"./MenuItem-CQqSdt0g.js";import{I as A}from"./InputAdornment-e-Ol_iUA.js";import{F as be}from"./FormControlLabel-ClSICk_D.js";import{C as Ce}from"./Checkbox-BP7c1We-.js";import{G as k}from"./Grid2-D3oxcX0N.js";import{L as ve}from"./Link-BJNZ9OZB.js";import"./format-number-big90whk.js";import"./label-CW2e8lfB.js";import"./image-I9HL7nG0.js";import"./Card-Ro7Utuy1.js";import"./Skeleton-YqBi0fMo.js";import"./LastPage-Dmj1gKFF.js";import"./listItemTextClasses-BH_LSGUS.js";function Pe(s){const r=K(),[a,i]=u.useState(()=>Array.isArray(s)?s.reduce((o,n)=>({...o,[n]:""}),{}):{[s]:""});return u.useMemo(()=>{const o=Object.keys(a),n=R.cloneDeep(a);return o.forEach(l=>{n[l]=r.get(l)}),R.isEqual(a,n)?a:n},[a,r])}function ke({products:s,loading:r,totalPages:a,onPageChange:i,currentPage:d}){const o=e.jsx(ge,{}),n=s.map((l,m)=>e.jsx(he,{product:l},l.id));return e.jsxs(e.Fragment,{children:[e.jsx(y,{display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)",lg:"repeat(4, 1fr)"},sx:{borderLeft:"1px solid rgba(255,255,255,0.2)",borderTop:"1px solid rgba(255,255,255,0.2)"},children:r?o:n}),s.length>0&&e.jsx(ye,{color:"primary",size:"large",shape:"rounded",page:d,count:a,onChange:(l,m)=>i(m),sx:{mt:{xs:5,md:8},[`& .${je.ul}`]:{justifyContent:"center"}}})]})}function Se({sort:s,onSort:r,sortOptions:a}){var o;const i=Y(),d=(o=a.find(n=>n.value===s))==null?void 0:o.label;return e.jsxs(e.Fragment,{children:[e.jsxs(F,{disableRipple:!0,color:"inherit",onClick:i.onOpen,endIcon:e.jsx(h,{icon:i.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill"}),sx:{fontWeight:"fontWeightSemiBold"},children:["Sắp xếp:",e.jsx(y,{component:"span",sx:{ml:.5,fontWeight:"fontWeightBold"},children:d})]}),e.jsx(V,{open:i.open,anchorEl:i.anchorEl,onClose:i.onClose,children:e.jsx(ee,{children:a.map(n=>e.jsx(fe,{selected:n.value===s,onClick:()=>{i.onClose(),r(n.value)},children:n.label},n.value))})})]})}function Fe({query:s,onSearch:r,loading:a}){return e.jsx(te,{fullWidth:!0,sx:{maxWidth:500},autoComplete:"off",value:s,onChange:i=>{r(i.target.value)},size:"small",placeholder:"Tìm kiếm...",InputProps:{startAdornment:e.jsx(A,{position:"start",children:e.jsx(h,{icon:"eva:search-fill",sx:{ml:1,color:"text.disabled"}})}),endAdornment:e.jsxs(A,{position:"end",children:[a?e.jsx(h,{icon:"svg-spinners:8-dots-rotate"}):null,!a&&s?e.jsx(h,{icon:"lets-icons:close-square-fill",onClick:()=>r(""),sx:{cursor:"pointer"}}):null]})}})}const q=[{value:"featured",label:"Nổi bật"},{value:"newest",label:"Mới nhất"},{value:"priceDesc",label:"Giá: cao - thấp"},{value:"priceAsc",label:"Giá: thấp - cao"}];function z({options:s,filters:r,title:a,onFilters:i}){const d=u.useCallback((o,n)=>{const l=r.includes(o);console.log(o,n,l,r,[...r,o]),l?i("subCategory",r.filter(m=>m!==o)):i("subCategory",[...r,o])},[i,r]);return e.jsxs(y,{display:"flex",flexDirection:"column",children:[e.jsx(j,{variant:"body1",sx:{mb:1,width:1,backgroundColor:"primary.dark",p:1,fontWeight:600},children:a}),s.map(o=>e.jsx(be,{control:e.jsx(Ce,{checked:r.includes(o)}),onChange:(n,l)=>d(o,l),label:o},o))]})}function De({filters:s,options:r,onFilters:a,onReset:i}){const d=se(),o=u.useMemo(()=>!!s.subCategory.length,[s]),n=e.jsxs(e.Fragment,{children:[e.jsxs(y,{display:"flex",alignItems:"center",sx:{py:2,pr:1,pl:2.5},children:[e.jsx(j,{variant:"h6",sx:{flexGrow:1},children:"Bộ lọc"}),e.jsx(re,{title:"Đặt lại bộ lọc",children:e.jsx(W,{onClick:i,children:e.jsx(M,{color:"error",variant:"dot",invisible:!o,children:e.jsx(h,{icon:"solar:restart-bold"})})})}),e.jsx(W,{onClick:d.onFalse,children:e.jsx(h,{icon:"mingcute:close-line"})})]}),e.jsx(oe,{sx:{borderStyle:"dashed"}})]});return e.jsxs(e.Fragment,{children:[e.jsx(F,{disableRipple:!0,color:"inherit",endIcon:e.jsx(M,{color:"error",variant:"dot",invisible:!o,children:e.jsx(h,{icon:"ic:round-filter-list"})}),onClick:d.onTrue,children:"Bộ lọc"}),e.jsxs(ne,{anchor:"right",open:d.value,onClose:d.onFalse,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:320}},children:[n,e.jsx(S,{sx:{px:2.5,py:3},children:e.jsx(g,{spacing:3,children:r.category.map(l=>e.jsx(z,{title:l.title,options:l.children||[],filters:s.subCategory,onFilters:a},l.title))})})]})]})}const C={category:"",subCategory:[],sort:q[0].value};function Ie(){const{categoryList:{list:s},categoryCountData:{list:r}}=ae(),{updateParams:a,updateParam:i}=ie(P.landing.product.root),[d,o]=u.useState(C.sort),{category:n,subCategory:l,p:m,q:N}=Pe(["category","subCategory","p","q"]),D=le("up","sm"),[I,H]=u.useState(()=>N||""),v=xe(I,400),[L,G]=u.useState(()=>m?Number(m):1),[c,f]=u.useState(()=>({...C,category:n||"",subCategory:l?l.split(","):[]})),w=u.useCallback((t,x)=>{f(p=>({...p,[t]:x}))},[f]);u.useEffect(()=>{a({...c.category&&{category:c.category.toString()},...c.subCategory.length&&{subCategory:c.subCategory.join(",")}})},[c]);const{data:B,productsLoading:E,productsEmpty:Q}=ce(20,L-1,v,c.subCategory.length?c.subCategory:[c.category||""],d),_=u.useMemo(()=>{const t=r.filter(p=>p.level===1);return[{id:"all",name:"Tất cả",count:t.reduce((p,J)=>p+J.count,0)},...t]},[r]),T=u.useMemo(()=>{const t={category:[{title:"",children:[]}]};if(c.category){const x=s.find(p=>p.name===c.category);x&&(t.category[0].title=x.name,t.category[0].children=x.categories.map(p=>p.name))}else t.category=s.map(x=>({title:x.name,children:x.categories.map(p=>p.name)}));return t},[s,c.category]),U=u.useCallback(t=>{o(t)},[]),$=u.useCallback(t=>{H(t)},[]),b=u.useCallback(t=>{t||c.category?f({...C,category:((t??null)!==null?t:c.category)||""}):f(C)},[c.category]);u.useEffect(()=>{i("q",v)},[v]);const X=e.jsxs(g,{spacing:3,justifyContent:"space-between",alignItems:{xs:"flex-end",sm:"center"},direction:{xs:"column",sm:"row"},children:[e.jsx(Fe,{query:I,onSearch:$,loading:E}),e.jsxs(g,{direction:"row",spacing:1,flexShrink:0,children:[!D&&e.jsx(De,{options:T,filters:c,onFilters:w,onReset:()=>b()}),e.jsx(Se,{sort:d,onSort:U,sortOptions:q})]})]}),Z=e.jsx(me,{filled:!0,sx:{py:10},title:"Sản phẩm đang được cập nhật"});return e.jsxs(e.Fragment,{children:[e.jsx(y,{sx:{backgroundColor:t=>t.palette.background.neutral,py:{xs:3,md:5}},children:e.jsxs(O,{children:[e.jsx(j,{variant:"h3",sx:{mb:{xs:3,md:5}},children:c.category}),e.jsx(S,{fillContent:!0,children:e.jsx(g,{direction:"row",spacing:3,minWidth:0,maxWidth:1,width:1,children:_.map(t=>e.jsxs(y,{minWidth:"fit-content",children:[e.jsx(Le,{title:t.name,href:t.id==="all"?P.landing.product.root:P.landing.product.category(t.name),onClick:()=>{t.id==="all"?b(""):b(t.name)},active:t.id==="all"&&!n?!0:t.name===n}),e.jsxs(j,{variant:"caption",sx:{},children:[t.count," sản phẩm"]})]},t.id))})})]})}),e.jsx(O,{sx:{mb:15,mt:3},children:e.jsxs(k,{container:!0,children:[e.jsx(k,{xs:0,sm:4,md:3,sx:{...!D&&{display:"none"}},children:e.jsxs(g,{spacing:3,sx:{pr:2,position:"sticky",top:80,maxHeight:"calc(100vh - var(--layout-header-desktop-height) *1.5)"},children:[e.jsx(S,{fillContent:!0,slotProps:{content:{pl:"8px !important"}},children:T.category.map(t=>e.jsx(z,{title:t.title,options:t.children||[],filters:c.subCategory,onFilters:w},t.title))}),e.jsx(F,{color:"primary",variant:"soft",onClick:()=>b(),children:"Đặt lại bộ lọc"})]})}),e.jsxs(k,{xs:12,sm:8,md:9,children:[e.jsx(g,{spacing:2.5,sx:{mb:{xs:3,md:5}},children:X}),Q&&Z,e.jsx(ke,{products:B.products,loading:E,totalPages:B.paginate.pageCount,onPageChange:t=>G(t),currentPage:L})]})]})})]})}function Le({title:s,href:r,onClick:a,active:i}){return e.jsx(ve,{component:de,href:r,sx:{textDecoration:"none"},onClick:a,children:e.jsx(j,{variant:"subtitle1",sx:{textTransform:"uppercase",transition:d=>d.transitions.create("textDecoration"),"&:hover":{textDecoration:"underline",color:"primary.main"},...i&&{textDecoration:"underline",color:"primary.main"}},children:s})})}const we={title:`Product shop - ${pe.site.name}`};function Ze(){return e.jsxs(e.Fragment,{children:[e.jsx(ue,{children:e.jsxs("title",{children:[" ",we.title]})}),e.jsx(Ie,{})]})}export{Ze as default};
