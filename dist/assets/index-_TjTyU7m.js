import{eI as z,eJ as A,r as u,f4 as re,eK as B,j as e,h as n,B as f,I as a,aw as $,aP as _,cz as N,ad as W,cy as J,l as S,d8 as K,T as j,db as ne,e as R,au as X,t as p,p as C,bb as ie,bc as te,c0 as ae,dj as V,f9 as le,d$ as ce,cg as de,cL as xe,d_ as he,f as F,dF as pe,dc as me,c as O,e8 as ue,n as je,ac as fe,w as k,cY as ge,H as be}from"./index-CZQdhxL6.js";import{E as D}from"./empty-content-CNoNRi_C.js";import{L as Y}from"./ListItemButton-B1Oqx7Ea.js";import{S as I}from"./Skeleton-hEu7t3F6.js";import{L as ve}from"./ListItemText-Cr03FIqH.js";import{I as q}from"./InputAdornment-FYGjj27N.js";import{E as Q}from"./editor-CDG2HKGW.js";import{L as ye}from"./label-VukvCSVc.js";import{M as we}from"./markdown-BDvZYkzP.js";import{F as ke}from"./file-thumbnail-DwL3Xnqg.js";import{C as H}from"./Checkbox-vPWnpj5r.js";import{L as Ce}from"./Link-aHbKcscn.js";import"./listItemButtonClasses-DXIYlEZ6.js";import"./listItemTextClasses-tNQx_Nyt.js";import"./index-SBExoyVP.js";import"./html-to-markdown-DZkUaXsX.js";import"./image-BKqVmPzF.js";const U={revalidateIfStale:!1,revalidateOnFocus:!1,revalidateOnReconnect:!1};function Ie(){const s=B.mail.labels,{data:r,isLoading:o,error:i,isValidating:t}=z(s,A,U);return u.useMemo(()=>({labels:(r==null?void 0:r.labels)||[],labelsLoading:o,labelsError:i,labelsValidating:t,labelsEmpty:!o&&!(r!=null&&r.labels.length)}),[r==null?void 0:r.labels,i,o,t])}function Le(s){const r=s?[B.mail.list,{params:{labelId:s}}]:"",{data:o,isLoading:i,error:t,isValidating:l}=z(r,A,U);return u.useMemo(()=>{const x=o!=null&&o.mails.length?re(o==null?void 0:o.mails,"id"):{},m=Object.keys(x);return{mails:{byId:x,allIds:m},mailsLoading:i,mailsError:t,mailsValidating:l,mailsEmpty:!i&&!m.length}},[o==null?void 0:o.mails,t,i,l])}function Se(s){const r=s?[B.mail.details,{params:{mailId:s}}]:"",{data:o,isLoading:i,error:t,isValidating:l}=z(r,A,U);return u.useMemo(()=>({mail:o==null?void 0:o.mail,mailLoading:i,mailError:t,mailValidating:l}),[o==null?void 0:o.mail,t,i,l])}function Me({slots:s,sx:r,...o}){return e.jsxs(n,{sx:r,...o,children:[s.header,e.jsxs(n,{spacing:1,direction:"row",sx:{flex:"1 1 auto",overflow:"hidden"},children:[e.jsx(n,{sx:{flex:"0 0 200px",overflow:"hidden",display:{xs:"none",md:"flex"}},children:s.nav}),e.jsx(n,{sx:{borderRadius:1.5,flex:"0 0 320px",overflow:"hidden",bgcolor:"background.default",display:{xs:"none",md:"flex"}},children:s.list}),e.jsx(n,{sx:{minWidth:0,flex:"1 1 auto",borderRadius:1.5,overflow:"hidden",bgcolor:"background.default"},children:s.details})]})]})}const Te={all:"fluent:mail-24-filled",inbox:"solar:inbox-bold",trash:"solar:trash-bin-trash-bold",drafts:"solar:file-text-bold",spam:"solar:danger-bold",sent:"iconamoon:send-fill",starred:"eva:star-fill",important:"material-symbols:label-important-rounded",social:"solar:tag-horizontal-bold-duotone",promotions:"solar:tag-horizontal-bold-duotone",forums:"solar:tag-horizontal-bold-duotone"};function Ee({selected:s,label:r,onClickNavItem:o,...i}){const t=Te[r.id];return e.jsx(f,{component:"li",sx:{display:"flex"},children:e.jsxs(Y,{disableGutters:!0,onClick:o,sx:{pl:1,pr:1.5,gap:2,borderRadius:.75,color:"text.secondary",...s&&{color:"text.primary"}},...i,children:[e.jsx(a,{icon:t,width:22,sx:{color:r.color}}),e.jsx(f,{component:"span",sx:{flexGrow:1,textTransform:"capitalize",typography:s?"subtitle2":"body2"},children:r.name}),!!r.unreadCount&&e.jsx(f,{component:"span",sx:{typography:"caption"},children:r.unreadCount})]})})}function Fe({amount:s=6,sx:r,...o}){return[...Array(s)].map((i,t)=>e.jsxs(n,{spacing:2,direction:"row",alignItems:"center",sx:{py:1,color:l=>$(l.vars.palette.grey["500Channel"],.24),...r},...o,children:[e.jsx(I,{variant:"circular",sx:{width:32,height:32,bgcolor:"currentColor"}}),e.jsx(I,{sx:{width:.5,height:10,bgcolor:"currentColor"}})]},t))}function Pe({amount:s=6,sx:r,...o}){return[...Array(s)].map((i,t)=>e.jsxs(n,{spacing:2,direction:"row",alignItems:"center",sx:{py:1,...r},...o,children:[e.jsx(I,{variant:"circular",sx:{width:40,height:40}}),e.jsxs(n,{spacing:1,flexGrow:1,children:[e.jsx(I,{sx:{width:.75,height:10}}),e.jsx(I,{sx:{width:.5,height:10}})]})]},t))}function $e({empty:s,labels:r,loading:o,openNav:i,onCloseNav:t,selectedLabelId:l,onToggleCompose:c,handleClickLabel:x}){const m=_(),g=e.jsx(n,{sx:{flex:"1 1 auto",px:{xs:2.5,md:1.5}},children:e.jsx(Fe,{})}),y=e.jsx(n,{sx:{flex:"1 1 auto",px:{xs:2.5,md:1.5}},children:e.jsx(D,{title:"No labels",imgUrl:`${S.site.basePath}/assets/icons/empty/ic-folder-empty.svg`})}),b=e.jsx(N,{sx:{flex:"1 1 0"},children:e.jsx("nav",{children:e.jsx(f,{component:"ul",sx:{pb:1.5,px:{xs:1.5,md:.5}},children:r.map(d=>e.jsx(Ee,{label:d,selected:l===d.id,onClickNavItem:()=>{x(d.id)}},d.id))})})}),h=e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{p:{xs:2.5,md:m.spacing(2,1.5)}},children:e.jsx(W,{fullWidth:!0,color:"inherit",variant:"contained",startIcon:e.jsx(a,{icon:"solar:pen-bold"}),onClick:c,children:"Compose"})}),o?g:e.jsx(e.Fragment,{children:s?y:b})]});return e.jsxs(e.Fragment,{children:[h,e.jsx(J,{open:i,onClose:t,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:280}},children:h})]})}function ze({mail:s,selected:r,sx:o,...i}){return e.jsx(f,{component:"li",sx:{display:"flex"},children:e.jsxs(Y,{disableGutters:!0,sx:{p:1,gap:2,borderRadius:1,...r&&{bgcolor:"action.selected"},...o},...i,children:[e.jsx(K,{alt:s.from.name,src:s.from.avatarUrl??"",children:s.from.name.charAt(0).toUpperCase()}),e.jsx(ve,{primary:s.from.name,primaryTypographyProps:{noWrap:!0,component:"span",variant:"subtitle2"},secondary:s.message,secondaryTypographyProps:{noWrap:!0,component:"span",variant:s.isUnread?"subtitle2":"body2",color:s.isUnread?"text.primary":"text.secondary"}}),e.jsxs(n,{alignItems:"flex-end",sx:{alignSelf:"stretch"},children:[e.jsx(j,{noWrap:!0,variant:"body2",component:"span",sx:{mb:1.5,fontSize:12,color:"text.disabled"},children:ne(s.createdAt)}),!!s.isUnread&&e.jsx(f,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"info.main"}})]})]})})}function Ae({empty:s,mails:r,loading:o,openMail:i,onCloseMail:t,onClickMail:l,selectedMailId:c,selectedLabelId:x}){const m=R("up","md"),g=e.jsx(n,{sx:{px:2,flex:"1 1 auto"},children:e.jsx(Pe,{})}),y=e.jsx(n,{sx:{px:2,flex:"1 1 auto"},children:e.jsx(D,{title:`Nothing in ${x}`,description:"This folder is empty",imgUrl:`${S.site.basePath}/assets/icons/empty/ic-folder-empty.svg`})}),b=e.jsx(N,{sx:{flex:"1 1 0"},children:e.jsx("nav",{children:e.jsx(f,{component:"ul",sx:{px:2,pb:1,gap:.5,display:"flex",flexDirection:"column"},children:r.allIds.map(d=>e.jsx(ze,{mail:r.byId[d],selected:c===d,onClick:()=>{l(d)}},d))})})}),h=e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{p:2},children:m?e.jsx(X,{placeholder:"Search...",InputProps:{startAdornment:e.jsx(q,{position:"start",children:e.jsx(a,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}):e.jsx(j,{variant:"h6",sx:{textTransform:"capitalize"},children:x})}),o?g:e.jsx(e.Fragment,{children:s?y:b})]});return e.jsxs(e.Fragment,{children:[h,e.jsx(J,{open:i,onClose:t,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:320}},children:h})]})}function Be({onOpenNav:s,onOpenMail:r,sx:o,...i}){return e.jsxs(n,{direction:"row",alignItems:"center",sx:{py:1,mb:1,...o},...i,children:[e.jsx(p,{onClick:s,children:e.jsx(a,{icon:"fluent:mail-24-filled"})}),r&&e.jsx(p,{onClick:r,children:e.jsx(a,{icon:"solar:chat-round-dots-bold"})}),e.jsx(X,{fullWidth:!0,size:"small",placeholder:"Search...",InputProps:{startAdornment:e.jsx(q,{position:"start",children:e.jsx(a,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})},sx:{ml:2}})]})}const L=20;function Ne({onCloseCompose:s}){const r=R("up","sm"),o=C(),[i,t]=u.useState(""),l=u.useCallback(c=>{t(c)},[]);return e.jsxs(ie,{children:[(o.value||!r)&&e.jsx(te,{open:!0,sx:{zIndex:c=>c.zIndex.modal-1}}),e.jsxs(ae,{sx:{maxWidth:560,right:L,borderRadius:2,display:"flex",bottom:L,position:"fixed",overflow:"hidden",flexDirection:"column",zIndex:c=>c.zIndex.modal,width:`calc(100% - ${L*2}px)`,boxShadow:c=>c.customShadows.dropdown,...o.value&&{maxWidth:1,height:`calc(100% - ${L*2}px)`}},children:[e.jsxs(n,{direction:"row",alignItems:"center",sx:{bgcolor:"background.neutral",p:c=>c.spacing(1.5,1,1.5,2)},children:[e.jsx(j,{variant:"h6",sx:{flexGrow:1},children:"New message"}),e.jsx(p,{onClick:o.onToggle,children:e.jsx(a,{icon:o.value?"eva:collapse-fill":"eva:expand-fill"})}),e.jsx(p,{onClick:s,children:e.jsx(a,{icon:"mingcute:close-line"})})]}),e.jsx(V,{placeholder:"To",endAdornment:e.jsxs(n,{direction:"row",spacing:.5,sx:{typography:"subtitle2"},children:[e.jsx(f,{sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:"Cc"}),e.jsx(f,{sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:"Bcc"})]}),sx:{px:2,height:48,borderBottom:c=>`solid 1px ${$(c.vars.palette.grey["500Channel"],.08)}`}}),e.jsx(V,{placeholder:"Subject",sx:{px:2,height:48,borderBottom:c=>`solid 1px ${$(c.vars.palette.grey["500Channel"],.08)}`}}),e.jsxs(n,{spacing:2,flexGrow:1,sx:{p:2,flex:"1 1 auto",overflow:"hidden"},children:[e.jsx(Q,{value:i,onChange:l,placeholder:"Type a message",slotProps:{wrap:{...o.value&&{minHeight:0,flex:"1 1 auto"}}},sx:{maxHeight:480,...o.value&&{maxHeight:1,flex:"1 1 auto"}}}),e.jsxs(n,{direction:"row",alignItems:"center",children:[e.jsxs(n,{direction:"row",alignItems:"center",flexGrow:1,children:[e.jsx(p,{children:e.jsx(a,{icon:"solar:gallery-add-bold"})}),e.jsx(p,{children:e.jsx(a,{icon:"eva:attach-2-fill"})})]}),e.jsx(W,{variant:"contained",color:"primary",endIcon:e.jsx(a,{icon:"iconamoon:send-fill"}),children:"Send"})]})]})]})]})}function We({mail:s,renderLabel:r,empty:o,loading:i}){const t=_(),l=C(!0);if(i)return e.jsx(le,{});if(o||!s)return e.jsx(D,{title:"No conversation selected",description:"Select a conversation to read",imgUrl:`${S.site.basePath}/assets/icons/empty/ic-email-selected.svg`});const c=e.jsxs(e.Fragment,{children:[e.jsx(n,{direction:"row",spacing:1,flexGrow:1,children:s.labelIds.map(h=>{const d=r(h);return d?e.jsx(ye,{sx:{color:ce(d.color,.24),bgcolor:de(d.color,.16),[xe.dark]:{color:he(d.color,.24)}},children:d.name},d.id):null})}),e.jsxs(n,{direction:"row",alignItems:"center",children:[e.jsx(H,{color:"warning",icon:e.jsx(a,{icon:"eva:star-outline"}),checkedIcon:e.jsx(a,{icon:"eva:star-fill"}),checked:s.isStarred,inputProps:{id:"starred-checkbox","aria-label":"Starred checkbox"}}),e.jsx(H,{color:"warning",icon:e.jsx(a,{icon:"material-symbols:label-important-rounded"}),checkedIcon:e.jsx(a,{icon:"material-symbols:label-important-rounded"}),checked:s.isImportant,inputProps:{id:"important-checkbox","aria-label":"Important checkbox"}}),e.jsx(F,{title:"Archive",children:e.jsx(p,{children:e.jsx(a,{icon:"solar:archive-down-minimlistic-bold"})})}),e.jsx(F,{title:"Mark Unread",children:e.jsx(p,{children:e.jsx(a,{icon:"fluent:mail-unread-20-filled"})})}),e.jsx(F,{title:"Trash",children:e.jsx(p,{children:e.jsx(a,{icon:"solar:trash-bin-trash-bold"})})}),e.jsx(p,{children:e.jsx(a,{icon:"eva:more-vertical-fill"})})]})]}),x=e.jsxs(e.Fragment,{children:[e.jsxs(j,{variant:"subtitle2",sx:{...pe({line:2}),flex:"1 1 auto"},children:["Re: ",s.subject]}),e.jsxs(n,{spacing:.5,children:[e.jsxs(n,{direction:"row",alignItems:"center",justifyContent:"flex-end",children:[e.jsx(p,{size:"small",children:e.jsx(a,{width:18,icon:"solar:reply-bold"})}),e.jsx(p,{size:"small",children:e.jsx(a,{width:18,icon:"solar:multiple-forward-left-broken"})}),e.jsx(p,{size:"small",children:e.jsx(a,{width:18,icon:"solar:forward-bold"})})]}),e.jsx(j,{variant:"caption",noWrap:!0,sx:{color:"text.disabled"},children:me(s.createdAt)})]})]}),m=e.jsxs(e.Fragment,{children:[e.jsx(K,{alt:s.from.name,src:s.from.avatarUrl?`${s.from.avatarUrl}`:"",sx:{mr:2},children:s.from.name.charAt(0).toUpperCase()}),e.jsxs(n,{spacing:.5,sx:{width:0,flexGrow:1},children:[e.jsxs(n,{spacing:.5,direction:"row",children:[e.jsx(j,{component:"span",variant:"subtitle2",sx:{flexShrink:0},children:s.from.name}),e.jsx(j,{component:"span",noWrap:!0,variant:"body2",sx:{color:"text.secondary"},children:`<${s.from.email}>`})]}),e.jsxs(j,{noWrap:!0,component:"span",variant:"caption",sx:{color:"text.secondary"},children:["To: ",s.to.map(h=>e.jsx(Ce,{color:"inherit",sx:{"&:hover":{color:"text.primary"}},children:`${h.email}, `},h.email))]})]})]}),g=e.jsxs(n,{spacing:1,sx:{p:1,borderRadius:1,bgcolor:"background.neutral"},children:[e.jsxs(n,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(O,{onClick:l.onToggle,sx:{borderRadius:.5,typography:"caption",color:"text.secondary"},children:[e.jsx(a,{icon:"eva:attach-2-fill",sx:{mr:.5}}),s.attachments.length," attachments",e.jsx(a,{icon:l.value?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill",width:16,sx:{ml:.5}})]}),e.jsxs(O,{sx:{py:.5,gap:.5,px:.75,borderRadius:.75,typography:"caption",fontWeight:"fontWeightSemiBold"},children:[e.jsx(a,{width:18,icon:"eva:cloud-download-fill"})," Download"]})]}),e.jsx(ue,{in:l.value,unmountOnExit:!0,timeout:"auto",children:e.jsx(n,{direction:"row",flexWrap:"wrap",spacing:.75,children:s.attachments.map(h=>e.jsx(ke,{tooltip:!0,imageView:!0,file:h.preview,onDownload:()=>console.info("DOWNLOAD"),sx:{width:48,height:48,backgroundColor:"background.neutral"},slotProps:{icon:{width:24,height:24}}},h.id))})})]}),y=e.jsx(we,{children:s.message,sx:{px:2,"& p":{typography:"body2"}}}),b=e.jsxs(e.Fragment,{children:[e.jsx(Q,{sx:{maxHeight:320}}),e.jsxs(n,{direction:"row",alignItems:"center",children:[e.jsx(p,{children:e.jsx(a,{icon:"solar:gallery-add-bold"})}),e.jsx(p,{children:e.jsx(a,{icon:"eva:attach-2-fill"})}),e.jsx(n,{flexGrow:1}),e.jsx(W,{color:"primary",variant:"contained",endIcon:e.jsx(a,{icon:"iconamoon:send-fill"}),children:"Send"})]})]});return e.jsxs(e.Fragment,{children:[e.jsx(n,{direction:"row",alignItems:"center",flexShrink:0,sx:{pl:2,pr:1,height:56},children:c}),e.jsx(n,{spacing:2,flexShrink:0,direction:"row",sx:{p:2,borderTop:`1px dashed ${t.vars.palette.divider}`,borderBottom:`1px dashed ${t.vars.palette.divider}`},children:x}),e.jsx(n,{flexShrink:0,direction:"row",alignItems:"center",sx:{pt:2,px:2},children:m}),!!s.attachments.length&&e.jsxs(n,{sx:{px:2,mt:2},children:[" ",g," "]}),e.jsx(N,{sx:{mt:3,flex:"1 1 240px"},children:y}),e.jsx(n,{flexShrink:0,spacing:2,sx:{p:2},children:b})]})}const P="inbox";function Re(){const s=je(),r=fe(),o=r.get("label")??P,i=r.get("id")??"",t=R("up","md"),l=C(),c=C(),x=C(),{labels:m,labelsLoading:g,labelsEmpty:y}=Ie(),{mails:b,mailsLoading:h,mailsError:d,mailsEmpty:M}=Le(o),{mail:Z,mailLoading:ee,mailError:G}=Se(i),T=b.allIds[0]||"",se=u.useCallback(()=>{l.value&&l.onFalse(),x.onToggle()},[x,l]),oe=u.useCallback(v=>{if(t||l.onFalse(),v){const w=v!==P?`${k.dashboard.mail}?label=${v}`:k.dashboard.mail;s.push(w)}},[l,s,t]),E=u.useCallback(v=>{t||c.onFalse();const w=o!==P?`${k.dashboard.mail}?id=${v}&label=${o}`:`${k.dashboard.mail}?id=${v}`;s.push(w)},[c,s,o,t]);return u.useEffect(()=>{(d||G)&&s.push(k.dashboard.mail)},[G,d,s]),u.useEffect(()=>{!i&&T&&E(T)},[T,E,i]),u.useEffect(()=>{x.value?document.body.style.overflow="hidden":document.body.style.overflow=""},[x.value]),e.jsxs(e.Fragment,{children:[e.jsxs(ge,{maxWidth:!1,sx:{flex:"1 1 auto",display:"flex",flexDirection:"column"},children:[e.jsx(j,{variant:"h4",sx:{mb:{xs:3,md:5}},children:"Mail"}),e.jsx(Me,{sx:{p:1,borderRadius:2,flex:"1 1 auto",bgcolor:"background.neutral"},slots:{header:e.jsx(Be,{onOpenNav:l.onTrue,onOpenMail:M?void 0:c.onTrue,sx:{display:{md:"none"}}}),nav:e.jsx($e,{labels:m,empty:y,loading:g,openNav:l.value,onCloseNav:l.onFalse,selectedLabelId:o,handleClickLabel:oe,onToggleCompose:se}),list:e.jsx(Ae,{mails:b,empty:M,loading:h||g,openMail:c.value,onCloseMail:c.onFalse,onClickMail:E,selectedLabelId:o,selectedMailId:i}),details:e.jsx(We,{mail:Z,empty:M,loading:h||ee,renderLabel:v=>m.filter(w=>w.id===v)[0]})}})]}),x.value&&e.jsx(Ne,{onCloseCompose:x.onFalse})]})}const De={title:`Mail | Dashboard - ${S.site.name}`};function ns(){return e.jsxs(e.Fragment,{children:[e.jsx(be,{children:e.jsxs("title",{children:[" ",De.title]})}),e.jsx(Re,{})]})}export{ns as default};
