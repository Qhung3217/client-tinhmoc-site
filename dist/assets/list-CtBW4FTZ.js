import{dK as v,r as a,j as e,dL as _,aV as $,b1 as Q,b2 as U,dM as q,aw as S,B as f,h as P,dl as J,dm as K,d8 as Y,p as Z,n as ee,cC as te,dN as M,w as p,cY as oe,ad as k,q as re,I as g,dO as ae,dP as se,cM as ne,H as le,l as ie}from"./index-DBDTQgzR.js";import"./product-new-edit-form-B512PJ5m.js";import{E as R}from"./empty-content-CrThrvhQ.js";import{C as ce}from"./confirm-dialog-1h5Sb0me.js";import{C as de}from"./custom-breadcrumbs-Cq6vi18c.js";import{M as I}from"./MenuItem-CXtkif-l.js";import{C as ue}from"./Checkbox-BGAset9J.js";import{a as me}from"./format-number-BCGWgCIZ.js";import{L as pe}from"./ListItemText-BWLBNFBh.js";import{L as he}from"./Link-yd2Vpoa3.js";import{C as ge}from"./Card-mcWuHIxM.js";import{D as fe,g as xe,G as C}from"./DataGrid-YGhc6_n5.js";import{G as be,a as Ce}from"./GridToolbarQuickFilter-Dtj1_gPR.js";import"./form-provider-DF3B5Qy9.js";import"./Rating-BR5M_yat.js";import"./visuallyHidden-Dan1xhjv.js";import"./editor-CEeV8CTK.js";import"./index-DN576CaX.js";import"./Slider-pDTHwapb.js";import"./RadioGroup-6rz6-lxn.js";import"./FormGroup-BmjtyYIO.js";import"./FormControlLabel-CbzyZjs_.js";import"./index-Dlen6Mw8.js";import"./countries-DSLisFCy.js";import"./search-not-found-CAvx5TG6.js";import"./InputAdornment-Bkememc_.js";import"./country-select-BgdOjkuY.js";import"./upload-CrEYFCVg.js";import"./preview-multi-file-BxqREHj2.js";import"./file-thumbnail-NlKfSiYl.js";import"./upload-box-Bzq2MqhI.js";import"./upload-avatar-DWbCayes.js";import"./image-DnyeokJc.js";import"./DatePicker-_e2J2jCh.js";import"./DialogActions-DxkFb4E3.js";import"./ListItem-B2jXz8Io.js";import"./listItemButtonClasses-D6WOaO0u.js";import"./dialogTitleClasses-dlJ2Dc6b.js";import"./DialogContent-Dc9_4vKy.js";import"./MobileDateTimePicker-CBzJXPzz.js";import"./Tabs-CiqW0Pdf.js";import"./KeyboardArrowRight-BXWDGu1s.js";import"./index-DixO9l5f.js";import"./CardHeader-CIF5Mw-j.js";import"./LoadingButton-DeHkswpr.js";import"./CircularProgress-27YVWvuS.js";import"./DialogTitle-ft8XbdqB.js";import"./listItemTextClasses-YBd3Kn_2.js";import"./ListItemIcon-D8IlJ1j6.js";import"./ClickAwayListener-BbJWI6yy.js";import"./Skeleton-ClMJhwxT.js";import"./TablePagination-DLsZRYWB.js";import"./LastPage-hAb5R5fv.js";import"./TableCell-Cyflqqsm.js";function je({filters:o,options:l}){const s=v({categories:o.state.categories}),m=a.useCallback(r=>{const{target:{value:n}}=r;s.setState({categories:typeof n=="string"?n.split(","):n})},[s]),c=a.useCallback(()=>{o.setState({categories:s.state.categories})},[o,s.state.categories]),d=a.useCallback(r=>()=>{const n=s.state.categories.indexOf(r),i=[...s.state.categories];n===-1?i.push(r):i.splice(n,1),s.setState({categories:i})},[s]),u=l.categories.reduce((r,n)=>(r.push(e.jsx(_,{children:n.name},n.name)),n.categories.forEach(i=>{r.push(e.jsxs(I,{value:i.name,onClick:d(i.name),children:[e.jsx(ue,{disableRipple:!0,size:"small",checked:s.state.categories.includes(i.name)}),i.name]},i.name))}),r),[]);return e.jsxs($,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(Q,{htmlFor:"product-filter-title-select-label",children:"Loại sản phẩm"}),e.jsxs(U,{multiple:!0,value:s.state.categories,onChange:m,onClose:c,input:e.jsx(q,{label:"Loại sản phẩm"}),renderValue:r=>r.join(", "),inputProps:{id:"product-filter-title-select-label"},sx:{textTransform:"capitalize"},children:[u,e.jsx(I,{onClick:c,sx:{justifyContent:"center",fontWeight:r=>r.typography.button,border:r=>`solid 1px ${S(r.vars.palette.grey["500Channel"],.16)}`,bgcolor:r=>S(r.vars.palette.grey["500Channel"],.08)},children:"Áp dụng"})]})]})}function we({params:o}){return o.row.slug}function ye({params:o}){return e.jsx(f,{sx:{display:"inline-block",padding:"2px 8px",borderRadius:"8px",backgroundColor:"primary.main",color:"white",textAlign:"center",minWidth:"24px"},children:o.row.priority})}function Se({params:o}){return me(o.row.price)}function Me({params:o}){return`${o.row.salePercent}%`}function ke({params:o}){return o.row.createBy.email}function Re({params:o}){return e.jsxs(P,{spacing:.5,children:[e.jsx(f,{component:"span",children:J(o.row.createdAt)}),e.jsx(f,{component:"span",sx:{typography:"caption",color:"text.secondary"},children:K(o.row.createdAt)})]})}function Ie({params:o,onViewRow:l}){return e.jsxs(P,{direction:"row",alignItems:"center",sx:{py:2,width:1},children:[e.jsx(Y,{alt:o.row.title,src:o.row.thumbnail,variant:"rounded",sx:{width:64,height:64,mr:2}}),e.jsx(pe,{disableTypography:!0,primary:e.jsx(he,{noWrap:!0,color:"inherit",variant:"subtitle2",onClick:l,sx:{cursor:"pointer"},children:o.row.title}),secondary:e.jsx(f,{component:"div",sx:{typography:"body2",color:"text.disabled"},children:o.row.category.name}),sx:{display:"flex",flexDirection:"column"}})]})}const ve={category:!1},Pe=["category","actions"];function Le(){const o=Z(),l=ee(),[s,m]=a.useState(10),[c,d]=a.useState(0),[u,r]=a.useState(""),[n,i]=a.useState([]),{data:L,productsLoading:D}=te(s,c,u,n),{products:x,paginate:T}=L,h=v({categories:[]});a.useEffect(()=>{m(s),d(c),i(h.state.categories)},[s,c,h]);const j=t=>{r(t.target.value),d(0)},E=a.useCallback(()=>e.jsx(De,{filters:h,handleSearchChange:j,search:u}),[j,u,h]),[G,N]=a.useState([]),[b,A]=a.useState([]),[B,F]=a.useState(null),[O,V]=a.useState(ve);a.useEffect(()=>{x.length&&N(x)},[x]);const z=async t=>{await M(t),ne.success("Xóa thành công!")},H=a.useCallback(async()=>{await Promise.all(b.map(t=>M(t.toString())))},[b]),W=a.useCallback(t=>{l.push(p.dashboard.product.edit(t))},[l]),w=a.useCallback(t=>{l.push(p.dashboard.product.details(t))},[l]),y=[{field:"category",headerName:"Category",filterable:!1},{field:"id",headerName:"Mã sản phẩm",width:160,sortable:!1,filterable:!1,disableColumnMenu:!0,renderCell:t=>e.jsx(we,{params:t})},{field:"name",headerName:"Sản phẩm",flex:1,minWidth:160,hideable:!1,sortable:!1,filterable:!1,disableColumnMenu:!0,renderCell:t=>e.jsx(Ie,{params:t,onViewRow:()=>w(t.row.slug)})},{field:"priority",headerName:"Độ ưu tiên",headerAlign:"center",width:100,editable:!0,align:"center",sortable:!1,filterable:!1,disableColumnMenu:!0,renderCell:t=>e.jsx(ye,{params:t})},{field:"price",headerName:"Giá",width:140,editable:!0,sortable:!1,filterable:!1,disableColumnMenu:!0,renderCell:t=>e.jsx(Se,{params:t})},{field:"salePercent",headerName:"Giảm giá",headerAlign:"center",align:"center",width:100,editable:!0,sortable:!1,filterable:!1,disableColumnMenu:!0,renderCell:t=>e.jsx(Me,{params:t})},{field:"createdAt",headerName:"Ngày tạo",width:160,sortable:!1,filterable:!1,disableColumnMenu:!0,renderCell:t=>e.jsx(Re,{params:t})},{field:"createBy",headerName:"Tạo bởi",width:110,sortable:!1,filterable:!1,disableColumnMenu:!0,renderCell:t=>e.jsx(ke,{params:t})},{type:"actions",field:"actions",headerName:" ",align:"right",headerAlign:"right",width:80,sortable:!1,filterable:!1,disableColumnMenu:!0,getActions:t=>[e.jsx(C,{showInMenu:!0,icon:e.jsx(g,{icon:"solar:eye-bold"}),label:"Xem",onClick:()=>w(t.row.slug)}),e.jsx(C,{showInMenu:!0,icon:e.jsx(g,{icon:"solar:pen-bold"}),label:"Sửa",onClick:()=>W(t.row.slug)}),e.jsx(C,{showInMenu:!0,icon:e.jsx(g,{icon:"solar:trash-bin-trash-bold"}),label:"Xóa",onClick:()=>{z(t.row.id)},sx:{color:"error.main"}})]}],X=()=>y.filter(t=>!Pe.includes(t.field)).map(t=>t.field);return e.jsxs(e.Fragment,{children:[e.jsxs(oe,{sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(de,{heading:"Danh sách",links:[{name:"Quản trị",href:p.dashboard.root},{name:"Sản phẩm",href:p.dashboard.product.root},{name:"Danh sách"}],action:e.jsx(k,{component:re,href:p.dashboard.product.new,variant:"contained",startIcon:e.jsx(g,{icon:"mingcute:add-line"}),children:"Thêm sản phẩm"}),sx:{mb:{xs:3,md:5}}}),e.jsx(ge,{sx:{flexGrow:{md:1},display:{md:"flex"},height:{xs:800,md:2},flexDirection:{md:"column"}},children:e.jsx(fe,{disableRowSelectionOnClick:!0,rows:G,columns:y,loading:D,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:s,page:c}}},rowCount:T.totalCount,paginationMode:"server",filterMode:"server",onPaginationModelChange:t=>{m(t.pageSize),d(t.page)},onRowSelectionModelChange:t=>A(t),columnVisibilityModel:O,onColumnVisibilityModelChange:t=>V(t),slots:{toolbar:E,noRowsOverlay:()=>e.jsx(R,{}),noResultsOverlay:()=>e.jsx(R,{title:"No results found"})},slotProps:{panel:{anchorEl:B},toolbar:{setFilterButtonEl:F},columnsManagement:{getTogglableColumns:X}},sx:{[`& .${xe.cell}`]:{alignItems:"center",display:"inline-flex"}}})})]}),e.jsx(ce,{open:o.value,onClose:o.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Bạn chắc chắn muốn xóa ",e.jsxs("strong",{children:[" ",b.length," "]})," sản phẩm?"]}),action:e.jsx(k,{variant:"contained",color:"error",onClick:()=>{H(),o.onFalse()},children:"Xóa"})})]})}function De({handleSearchChange:o,search:l,filters:s}){const[m,c]=a.useState(l),d=a.useMemo(()=>ae.debounce(n=>o(n),500),[o]),u=n=>{c(n.target.value),d(n)};a.useEffect(()=>{c(l)},[l]);const{categories:r}=se();return e.jsxs(be,{children:[e.jsx(je,{filters:s,options:{categories:r}}),e.jsx(Ce,{onChange:u,value:m,placeholder:"Mã hoặc tên sản phẩm..."})]})}const Te={title:`Sản phẩm | ${ie.site.name}`};function Et(){return e.jsxs(e.Fragment,{children:[e.jsx(le,{children:e.jsxs("title",{children:[" ",Te.title]})}),e.jsx(Le,{})]})}export{Et as default};
