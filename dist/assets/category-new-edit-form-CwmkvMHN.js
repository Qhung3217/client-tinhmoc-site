import{n as v,dP as L,r as o,e5 as S,e6 as E,cM as F,w as A,j as e,ap as D,h as l}from"./index-DBDTQgzR.js";import{z as d,u as V,t as g,F as h,a as k}from"./form-provider-DF3B5Qy9.js";import{a9 as z}from"./index-DixO9l5f.js";import"./image-DnyeokJc.js";import"./editor-CEeV8CTK.js";import{C as M}from"./Card-mcWuHIxM.js";import{C as N}from"./CardHeader-CIF5Mw-j.js";import{L as P}from"./LoadingButton-DeHkswpr.js";const R=d.object({name:d.string().min(1,{message:"Tên sản phẩm là bắt buộc!"}),parentId:d.string().nullable()});function Q({currentCategory:s}){const c=v(),{categories:x,categoriesLoading:r}=L(),n=o.useMemo(()=>({name:(s==null?void 0:s.name)||"",parentId:typeof(s==null?void 0:s.parentId)=="string"?s==null?void 0:s.parentId:null}),[s]);console.dir(s),console.dir(n);const a=V({mode:"all",resolver:g(R),defaultValues:n});o.useEffect(()=>{a.reset(n)},[s,n,a]);const{reset:t,watch:f,setValue:m,handleSubmit:u,formState:{isSubmitting:j}}=a,p=f();o.useEffect(()=>{m("parentId",p.parentId,{shouldValidate:!0})},[m,p.parentId]),o.useEffect(()=>{s&&t(n)},[s,n,t]);const b=u(async i=>{try{console.log("DATA after upload",i),i.parentId===""&&(i.parentId=null),s?await E(s.id,i):await S(i),t(),F.success(s?"Chỉnh sửa thành công!":"Thêm thành công!"),c.push(A.dashboard.category.root)}catch(T){console.error(T)}}),I=e.jsxs(M,{children:[e.jsx(N,{title:"Thông tin loại sản phẩm",subheader:"Tên sản phẩm",sx:{mb:3}}),e.jsx(D,{}),e.jsxs(l,{spacing:3,sx:{p:3},children:[e.jsx(h.Text,{name:"name",label:"Tên loại sản phẩm *"}),r?e.jsx(z,{}):e.jsxs(h.Select,{native:!0,name:"parentId",label:"Loại sản phẩm cấp 1",InputLabelProps:{shrink:!0},children:[e.jsx("option",{value:"",children:"Không có"},""),x.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))]})]})]}),w=e.jsx(l,{spacing:3,direction:"row",alignItems:"center",flexWrap:"wrap",children:e.jsx(P,{type:"submit",variant:"contained",size:"large",loading:j,children:s?"Lưu thay đổi":"Thêm loại sản phẩm"})});return e.jsx(k,{methods:a,onSubmit:b,children:e.jsxs(l,{spacing:{xs:3,md:5},sx:{mx:"auto",maxWidth:{xs:720,xl:880}},children:[I,w]})})}export{Q as C};
