import{eI as $e,eJ as Ne,r as c,eK as Ee,f5 as R,aF as P,h as k,cL as X,aw as L,j as e,B as y,d6 as ee,c0 as te,dj as re,eg as Y,aU as Re,aX as fe,p as M,t as $,I as j,cw as be,aZ as je,ad as W,cM as se,aP as Ke,dA as Ue,d8 as H,T as _,e as We,f as J,c as Be,db as _e,fb as le,au as oe,cz as ye,b4 as ce,b3 as Me,d9 as ze,cy as He,bb as Ge,fc as Ve,cY as Xe,b0 as Ye,H as Je,l as qe}from"./index-u4c5uTy0.js";import{K as U,c as Ze,g as Ce,u as ve,C as Qe,d as Pe,D as en,a as nn,b as an,e as ne,f as de,p as sn,r as tn,h as rn,M as on,S as ue,i as ln,v as cn,j as dn,T as un,k as mn,l as me}from"./sortable.esm-CtgjjDJO.js";import{E as hn}from"./empty-content-CuZPPhHf.js";import{u as ke}from"./uuidv4-B4SGT1yQ.js";import{C as we}from"./ClickAwayListener-DyIoSbg1.js";import{L as xn}from"./label-CW2e8lfB.js";import{C as Se}from"./confirm-dialog-BRBREL0G.js";import{M as Q}from"./MenuItem-CQqSdt0g.js";import{i as Te,I as pn}from"./image-I9HL7nG0.js";import{L as gn}from"./ListItem-sdN4-Rey.js";import{A as fn}from"./AvatarGroup-C3o9h28X.js";import{u as bn}from"./use-tabs-iw4nIijl.js";import{C as jn}from"./custom-tabs-COJOWpIV.js";import{u as yn}from"./use-date-range-picker-se6WgOSw.js";import{C as Cn}from"./custom-date-range-picker-Bm5_yid9.js";import{M as vn}from"./preview-multi-file-D7tdaa3h.js";import{U as kn}from"./upload-box-DLJzHV-X.js";import{u as wn,L as Sn}from"./use-light-box-DN1qWpi3.js";import{u as Tn}from"./use-mocked-user-Bqg4VEIz.js";import{S as In}from"./search-not-found-B6Ka3ota.js";import{D as Dn}from"./dialogTitleClasses-Cq2WiJNn.js";import{D as On}from"./DialogTitle-BLfIj25N.js";import{I as Fn}from"./InputAdornment-e-Ol_iUA.js";import{D as An}from"./DialogContent-BARz1C5J.js";import{L as Ln}from"./ListItemText-DI6-3wIs.js";import{a as $n}from"./Tabs-Cnx4LrgW.js";import{F as Nn}from"./FormGroup-DIodW3BI.js";import{F as Ie}from"./FormControlLabel-ClSICk_D.js";import{C as En}from"./Checkbox-BP7c1We-.js";import{S as q}from"./Skeleton-YqBi0fMo.js";import"./DialogActions-CqCNwb2o.js";import"./listItemTextClasses-BH_LSGUS.js";import"./listItemButtonClasses-BTeIgqK3.js";import"./DatePicker-Dt-kgJxG.js";import"./index-CcA_k5fi.js";import"./visuallyHidden-Dan1xhjv.js";import"./format-number-big90whk.js";import"./file-thumbnail-4Aiz5ZOI.js";import"./index-CxQHrayw.js";import"./KeyboardArrowRight-C4NP_Fdf.js";const ae=!1,N=Ee.kanban,Rn={revalidateIfStale:ae,revalidateOnFocus:ae,revalidateOnReconnect:ae};function Kn(){const{data:n,isLoading:a,error:s,isValidating:t}=$e(N,Ne,Rn);return c.useMemo(()=>{const o=(n==null?void 0:n.board.tasks)??{},d=(n==null?void 0:n.board.columns)??[];return{board:{tasks:o,columns:d},boardLoading:a,boardError:s,boardValidating:t,boardEmpty:!a&&!d.length}},[n==null?void 0:n.board.columns,n==null?void 0:n.board.tasks,s,a,t])}async function Un(n){R(N,a=>{const{board:s}=a,t=[...s.columns,n],r={...s.tasks,[n.id]:[]};return{...a,board:{...s,columns:t,tasks:r}}},!1)}async function Wn(n,a){R(N,s=>{const{board:t}=s,r=t.columns.map(o=>o.id===n?{...o,name:a}:o);return{...s,board:{...t,columns:r}}},!1)}async function Bn(n){R(N,a=>{const{board:s}=a;return{...a,board:{...s,columns:n}}},!1)}async function _n(n){R(N,a=>{const{board:s}=a,t={...s.tasks,[n]:[]};return{...a,board:{...s,tasks:t}}},!1)}async function Mn(n){R(N,a=>{const{board:s}=a,t=s.columns.filter(o=>o.id!==n),r=Object.keys(s.tasks).filter(o=>o!==n).reduce((o,d)=>(o[d]=s.tasks[d],o),{});return{...a,board:{...s,columns:t,tasks:r}}},!1)}async function zn(n,a){R(N,s=>{const{board:t}=s,r={...t.tasks,[n]:[a,...t.tasks[n]]};return{...s,board:{...t,tasks:r}}},!1)}async function Hn(n,a){R(N,s=>{const{board:t}=s,o=t.tasks[n].map(m=>m.id===a.id?{...m,...a}:m),d={...t.tasks,[n]:o};return{...s,board:{...t,tasks:d}}},!1)}async function he(n){R(N,a=>{const{board:s}=a;return{...a,board:{...s,tasks:n}}},!1)}async function Gn(n,a){R(N,s=>{const{board:t}=s,r={...t.tasks,[n]:t.tasks[n].filter(o=>o.id!==a)};return{...s,board:{...t,tasks:r}}},!1)}const b={item:"mnl__kanban__item",column:"mnl__kanban__column",itemWrap:"mnl__kanban__item__wrap",columnList:"mnl__kanban__column_list",state:{hover:"state-hover",fadeIn:"state-fade-in",sorting:"state-sorting",dragging:"state-dragging",disabled:"state-disabled",dragOverlay:"state-drag-overlay"}},Vn=[U.Down,U.Right,U.Up,U.Left],Xn=(n,{context:{active:a,droppableRects:s,droppableContainers:t,collisionRect:r}})=>{var o;if(Vn.includes(n.code)){if(n.preventDefault(),!a||!r)return;const d=[];t.getEnabled().forEach(l=>{var f;if(!l||l!=null&&l.disabled)return;const x=s.get(l.id);if(!x)return;const g=l.data.current;if(g){const{type:S,children:w}=g;if(S==="container"&&(w==null?void 0:w.length)>0&&((f=a.data.current)==null?void 0:f.type)!=="container")return}switch(n.code){case U.Down:r.top<x.top&&d.push(l);break;case U.Up:r.top>x.top&&d.push(l);break;case U.Left:r.left>=x.left+x.width&&d.push(l);break;case U.Right:r.left+r.width<=x.left&&d.push(l);break}});const m=Ze({active:a,collisionRect:r,droppableRects:s,droppableContainers:d,pointerCoordinates:null}),i=Ce(m,"id");if(i!=null){const l=t.get(i),x=l==null?void 0:l.node.current,g=l==null?void 0:l.rect.current;if(x&&g)return l.id==="placeholder"?{x:g.left+(g.width-r.width)/2,y:g.top+(g.height-r.height)/2}:((o=l.data.current)==null?void 0:o.type)==="container"?{x:g.left+20,y:g.top+74}:{x:g.left,y:g.top}}}},Yn=P(k)(({theme:n})=>({flexShrink:0,height:"100%",borderWidth:1,position:"relative",borderStyle:"solid",borderColor:"transparent",padding:"var(--column-padding)",borderRadius:"var(--column-radius)",backgroundColor:n.vars.palette.background.neutral,[X.dark]:{backgroundColor:n.vars.palette.grey[800]},"&::before":{top:0,left:0,content:'""',width:"100%",height:"100%",position:"absolute",borderRadius:"inherit",backgroundColor:"transparent",transition:n.transitions.create(["background-color"])},[`&.${b.state.hover}`]:{"&::before":{backgroundColor:L(n.vars.palette.grey["500Channel"],.08),[X.dark]:{backgroundColor:L(n.vars.palette.grey["500Channel"],.16)}}},[`&.${b.state.dragOverlay}`]:{backdropFilter:"blur(6px)",borderColor:L(n.vars.palette.grey["500Channel"],.08),backgroundColor:L(n.vars.palette.background.neutralChannel,.48),[X.dark]:{backgroundColor:L(n.vars.palette.grey["800Channel"],.48)}},[`&.${b.state.dragging}`]:{opacity:0}})),Jn=c.forwardRef(({slots:n,stateProps:a,sx:s,...t},r)=>{const o=b.column.concat((a==null?void 0:a.hover)&&` ${b.state.hover}`||(a==null?void 0:a.dragOverlay)&&` ${b.state.dragOverlay}`||(a==null?void 0:a.dragging)&&` ${b.state.dragging}`||"");return e.jsxs(Yn,{ref:r,className:o,sx:{gap:2.5,width:"var(--column-width)",...s},...t,children:[(n==null?void 0:n.header)&&n.header,(n==null?void 0:n.action)&&(n==null?void 0:n.action),(n==null?void 0:n.main)&&e.jsx(y,{component:"ul",className:b.columnList,sx:{minHeight:80,display:"flex",gap:"var(--item-gap)",flexDirection:"column"},children:n.main})]})}),De=c.memo(Jn);function qn({status:n,openAddTask:a,onAddTask:s,onCloseAddTask:t}){const[r,o]=c.useState(""),d=c.useMemo(()=>({id:ke(),status:n,name:r.trim()?r:"Untitled",priority:"medium",attachments:[],labels:[],comments:[],assignee:[],due:[null,null],reporter:{id:ee.id(16),name:ee.fullName(16),avatarUrl:ee.image.avatar(16)}}),[n,r]),m=c.useCallback(x=>{o(x.target.value)},[]),i=c.useCallback(x=>{x.key==="Enter"&&(s(d),o(""))},[d,s]),l=c.useCallback(()=>{o(""),t()},[t]);return a?e.jsx(we,{onClickAway:l,children:e.jsxs("div",{children:[e.jsx(te,{sx:{borderRadius:1.5,bgcolor:"background.default",boxShadow:x=>x.customShadows.z1},children:e.jsx(re,{autoFocus:!0,fullWidth:!0,placeholder:"Untitled",value:r,onChange:m,onKeyUp:i,sx:{px:2,height:56,[`& .${Y.input}`]:{p:0,typography:"subtitle2"}}})}),e.jsx(Re,{sx:{mx:1},children:"Press Enter to create the task."})]})}):null}function Oe({sx:n,...a}){return e.jsx(re,{sx:{[`&.${Y.root}`]:{py:.75,borderRadius:1,typography:"h6",borderWidth:2,borderStyle:"solid",borderColor:"transparent",transition:s=>s.transitions.create(["padding-left","border-color"]),[`&.${Y.focused}`]:{pl:.75,borderColor:"text.primary"}},[`& .${Y.input}`]:{typography:"h6"},...n},...a})}function Fe({columnName:n,totalTasks:a,handleProps:s,onClearColumn:t,onToggleAddTask:r,onDeleteColumn:o,onUpdateColumn:d}){const m=c.useRef(null),i=fe(),l=M(),[x,g]=c.useState(n);c.useEffect(()=>{i.open&&m.current&&m.current.focus()},[i.open]);const f=c.useCallback(w=>{g(w.target.value)},[]),S=c.useCallback(w=>{w.key==="Enter"&&(m.current&&m.current.blur(),d==null||d(x))},[x,d]);return e.jsxs(e.Fragment,{children:[e.jsxs(k,{direction:"row",alignItems:"center",children:[e.jsx(xn,{sx:{borderRadius:"50%",borderColor:w=>L(w.vars.palette.grey["500Channel"],.24)},children:a}),e.jsx(Oe,{inputRef:m,placeholder:"Column name",value:x,onChange:f,onKeyUp:S,inputProps:{id:`input-column-${x}`},sx:{mx:1}}),e.jsx($,{size:"small",color:"inherit",onClick:r,children:e.jsx(j,{icon:"solar:add-circle-bold"})}),e.jsx($,{size:"small",color:i.open?"inherit":"default",onClick:i.onOpen,children:e.jsx(j,{icon:"solar:menu-dots-bold-duotone"})}),e.jsx($,{size:"small",...s,children:e.jsx(j,{icon:"nimbus:drag-dots"})})]}),e.jsx(be,{open:i.open,anchorEl:i.anchorEl,onClose:i.onClose,children:e.jsxs(je,{children:[e.jsxs(Q,{onClick:i.onClose,children:[e.jsx(j,{icon:"solar:pen-bold"}),"Rename"]}),e.jsxs(Q,{onClick:()=>{t==null||t(),i.onClose()},children:[e.jsx(j,{icon:"solar:eraser-bold"}),"Clear"]}),e.jsxs(Q,{onClick:()=>{l.onTrue(),i.onClose()},sx:{color:"error.main"},children:[e.jsx(j,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),e.jsx(Se,{open:l.value,onClose:l.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete column?",e.jsxs(y,{sx:{typography:"caption",color:"error.main",mt:2},children:[e.jsx("strong",{children:" NOTE: "})," All tasks related to this category will also be deleted."]})]}),action:e.jsx(W,{variant:"contained",color:"error",onClick:()=>{o==null||o(),l.onFalse()},children:"Delete"})})]})}function Zn({children:n,column:a,tasks:s,disabled:t,sx:r}){var h;const o=M(),{attributes:d,isDragging:m,listeners:i,setNodeRef:l,transition:x,active:g,over:f,transform:S}=ve({id:a.id,data:{type:"container",children:s},animateLayoutChanges:Qn}),w=s.map(p=>p.id),O=f?a.id===f.id&&((h=g==null?void 0:g.data.current)==null?void 0:h.type)!=="container"||w.includes(f.id):!1,C=c.useCallback(async p=>{try{a.name!==p&&(Wn(a.id,p),se.success("Update success!",{position:"top-center"}))}catch(T){console.error(T)}},[a.id,a.name]),E=c.useCallback(async()=>{try{_n(a.id)}catch(p){console.error(p)}},[a.id]),G=c.useCallback(async()=>{try{Mn(a.id),se.success("Delete success!",{position:"top-center"})}catch(p){console.error(p)}},[a.id]),V=c.useCallback(async p=>{try{zn(a.id,p),o.onFalse()}catch(T){console.error(T)}},[a.id,o]);return e.jsx(De,{ref:t?void 0:l,sx:{transition:x,transform:Qe.Translate.toString(S),...r},stateProps:{dragging:m,hover:O,handleProps:{...d,...i}},slots:{header:e.jsx(Fe,{handleProps:{...d,...i},totalTasks:s.length,columnName:a.name,onUpdateColumn:C,onClearColumn:E,onDeleteColumn:G,onToggleAddTask:o.onToggle}),main:e.jsx(e.Fragment,{children:n}),action:e.jsx(qn,{status:a.name,openAddTask:o.value,onAddTask:V,onCloseAddTask:o.onFalse})}})}const Qn=n=>Pe({...n,wasDragging:!0}),Pn=P(gn)(()=>({"@keyframes fadeIn":{"0%":{opacity:0},"100%":{opacity:1}},transform:"translate3d(var(--translate-x, 0), var(--translate-y, 0), 0) scaleX(var(--scale-x, 1)) scaleY(var(--scale-y, 1))",transformOrigin:"0 0",touchAction:"manipulation",[`&.${b.state.fadeIn}`]:{animation:"fadeIn 500ms ease"},[`&.${b.state.dragOverlay}`]:{zIndex:999}})),ea=P(k)(({theme:n})=>({width:"100%",cursor:"grab",outline:"none",overflow:"hidden",position:"relative",transformOrigin:"50% 50%",touchAction:"manipulation",boxShadow:n.customShadows.z1,borderRadius:"var(--item-radius)",WebkitTapHighlightColor:"transparent",backgroundColor:n.vars.palette.common.white,transition:n.transitions.create(["box-shadow"]),[X.dark]:{backgroundColor:n.vars.palette.grey[900]},[`&.${b.state.disabled}`]:{},[`&.${b.state.sorting}`]:{},[`&.${b.state.dragOverlay}`]:{backdropFilter:"blur(6px)",boxShadow:n.customShadows.z20,backgroundColor:L(n.vars.palette.common.whiteChannel,.48),[X.dark]:{backgroundColor:L(n.vars.palette.grey["900Channel"],.48)}},[`&.${b.state.dragging}`]:{opacity:.2,filter:"grayscale(1)"}})),na=c.forwardRef(({task:n,stateProps:a,sx:s,...t},r)=>{var g,f,S,w,O,C;const o=Ke();c.useEffect(()=>{if(a!=null&&a.dragOverlay)return document.body.style.cursor="grabbing",()=>{document.body.style.cursor=""}},[a==null?void 0:a.dragOverlay]);const d=b.itemWrap.concat((a==null?void 0:a.fadeIn)&&` ${b.state.fadeIn}`||(a==null?void 0:a.dragOverlay)&&` ${b.state.dragOverlay}`||""),m=b.item.concat((a==null?void 0:a.dragging)&&` ${b.state.dragging}`||(a==null?void 0:a.disabled)&&` ${b.state.disabled}`||(a==null?void 0:a.sorting)&&` ${b.state.sorting}`||(a==null?void 0:a.dragOverlay)&&` ${b.state.dragOverlay}`||""),i=e.jsx(j,{icon:n.priority==="low"&&"solar:double-alt-arrow-down-bold-duotone"||n.priority==="medium"&&"solar:double-alt-arrow-right-bold-duotone"||"solar:double-alt-arrow-up-bold-duotone",sx:{top:4,right:4,position:"absolute",...n.priority==="low"&&{color:"info.main"},...n.priority==="medium"&&{color:"warning.main"},...n.priority==="hight"&&{color:"error.main"}}}),l=!!((g=n==null?void 0:n.attachments)!=null&&g.length)&&e.jsx(y,{sx:{p:o.spacing(1,1,0,1)},children:e.jsx(y,{component:"img",className:Te.root,alt:(f=n==null?void 0:n.attachments)==null?void 0:f[0],src:(S=n==null?void 0:n.attachments)==null?void 0:S[0],sx:{width:320,height:"auto",borderRadius:1.5,aspectRatio:"4/3",objectFit:"cover"}})}),x=e.jsxs(k,{direction:"row",alignItems:"center",children:[e.jsxs(k,{flexGrow:1,direction:"row",alignItems:"center",sx:{typography:"caption",color:"text.disabled"},children:[e.jsx(j,{width:16,icon:"solar:chat-round-dots-bold",sx:{mr:.25}}),e.jsx(y,{component:"span",sx:{mr:1},children:(w=n==null?void 0:n.comments)==null?void 0:w.length}),e.jsx(j,{width:16,icon:"eva:attach-2-fill",sx:{mr:.25}}),e.jsx(y,{component:"span",children:(O=n==null?void 0:n.attachments)==null?void 0:O.length})]}),e.jsx(fn,{sx:{[`& .${Ue.avatar}`]:{width:24,height:24}},children:(C=n==null?void 0:n.assignee)==null?void 0:C.map(E=>e.jsx(H,{alt:E.name,src:E.avatarUrl},E.id))})]});return e.jsx(Pn,{ref:r,disablePadding:!0,className:d,sx:{...!!(a!=null&&a.transition)&&{transition:a.transition},...!!(a!=null&&a.transform)&&{"--translate-x":`${Math.round(a.transform.x)}px`,"--translate-y":`${Math.round(a.transform.y)}px`,"--scale-x":`${a.transform.scaleX}`,"--scale-y":`${a.transform.scaleY}`}},children:e.jsxs(ea,{className:m,"data-cypress":"draggable-item",sx:s,tabIndex:0,...a==null?void 0:a.listeners,...t,children:[l,e.jsxs(k,{spacing:2,sx:{px:2,py:2.5,position:"relative"},children:[i,e.jsx(_,{variant:"subtitle2",children:n.name}),x]})]})})}),ie=c.memo(na);function aa({liked:n,onLike:a,taskName:s,onDelete:t,taskStatus:r,onCloseDetails:o}){const d=We("up","sm"),m=M(),i=fe(),[l,x]=c.useState(r),g=c.useCallback(f=>{i.onClose(),x(f)},[i]);return e.jsxs(e.Fragment,{children:[e.jsxs(k,{direction:"row",alignItems:"center",sx:{p:f=>f.spacing(2.5,1,2.5,2.5),borderBottom:f=>`solid 1px ${f.vars.palette.divider}`},children:[!d&&e.jsx(J,{title:"Back",children:e.jsx($,{onClick:o,sx:{mr:1},children:e.jsx(j,{icon:"eva:arrow-ios-back-fill"})})}),e.jsx(W,{size:"small",variant:"soft",endIcon:e.jsx(j,{icon:"eva:arrow-ios-downward-fill",width:16,sx:{ml:-.5}}),onClick:i.onOpen,children:l}),e.jsxs(k,{direction:"row",justifyContent:"flex-end",flexGrow:1,children:[e.jsx(J,{title:"Like",children:e.jsx($,{color:n?"default":"primary",onClick:a,children:e.jsx(j,{icon:"ic:round-thumb-up"})})}),e.jsx(J,{title:"Delete task",children:e.jsx($,{onClick:m.onTrue,children:e.jsx(j,{icon:"solar:trash-bin-trash-bold"})})}),e.jsx($,{children:e.jsx(j,{icon:"eva:more-vertical-fill"})})]})]}),e.jsx(be,{open:i.open,anchorEl:i.anchorEl,onClose:i.onClose,slotProps:{arrow:{placement:"top-right"}},children:e.jsx(je,{children:["To do","In progress","Ready to test","Done"].map(f=>e.jsx(Q,{selected:l===f,onClick:()=>{g(f)},children:f},f))})}),e.jsx(Se,{open:m.value,onClose:m.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Are you sure want to delete ",e.jsxs("strong",{children:[" ",s," "]}),"?"]}),action:e.jsx(W,{variant:"contained",color:"error",onClick:t,children:"Delete"})})]})}function sa({priority:n,onChangePriority:a}){return e.jsx(k,{direction:"row",flexWrap:"wrap",spacing:1,children:["low","medium","hight"].map(s=>e.jsxs(Be,{onClick:()=>a(s),sx:{py:.5,pl:.75,pr:1.25,fontSize:12,borderRadius:1,lineHeight:"20px",textTransform:"capitalize",fontWeight:"fontWeightBold",boxShadow:t=>`inset 0 0 0 1px ${L(t.vars.palette.grey["500Channel"],.24)}`,...s===n&&{boxShadow:t=>`inset 0 0 0 2px ${t.vars.palette.text.primary}`}},children:[e.jsx(j,{icon:s==="low"&&"solar:double-alt-arrow-down-bold-duotone"||s==="medium"&&"solar:double-alt-arrow-right-bold-duotone"||"solar:double-alt-arrow-up-bold-duotone",sx:{mr:.5,...s==="low"&&{color:"info.main"},...s==="medium"&&{color:"warning.main"},...s==="hight"&&{color:"error.main"}}}),s]},s))})}function ta({attachments:n}){const[a,s]=c.useState(n),t=c.useCallback(o=>{s([...a,...o])},[a]),r=c.useCallback(o=>{const d=a.filter(m=>m!==o);s(d)},[a]);return e.jsx(vn,{thumbnail:!0,files:a,onRemove:o=>r(o),slotProps:{thumbnail:{sx:{width:64,height:64}}},lastNode:e.jsx(kn,{onDrop:t})})}function ra({comments:n}){const a=n.filter(t=>t.messageType==="image").map(t=>({src:t.message})),s=wn(a);return e.jsxs(e.Fragment,{children:[e.jsx(k,{component:"ul",spacing:3,children:n.map(t=>e.jsxs(k,{component:"li",direction:"row",spacing:2,children:[e.jsx(H,{src:t.avatarUrl}),e.jsxs(k,{spacing:t.messageType==="image"?1:.5,flexGrow:1,children:[e.jsxs(k,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(_,{variant:"subtitle2",children:[" ",t.name]}),e.jsx(_,{variant:"caption",sx:{color:"text.disabled"},children:_e(t.createdAt)})]}),t.messageType==="image"?e.jsx(pn,{alt:t.message,src:t.message,onClick:()=>s.onOpen(t.message),sx:{borderRadius:1.5,cursor:"pointer",transition:r=>r.transitions.create(["opacity"]),"&:hover":{opacity:.8}}}):e.jsx(_,{variant:"body2",children:t.message})]})]},t.id))}),e.jsx(Sn,{index:s.selected,slides:a,open:s.open,close:s.onClose})]})}function oa(){var a;const{user:n}=Tn();return e.jsxs(k,{direction:"row",spacing:2,sx:{py:3,px:2.5},children:[e.jsx(H,{src:n==null?void 0:n.photoURL,alt:n==null?void 0:n.displayName,children:(a=n==null?void 0:n.displayName)==null?void 0:a.charAt(0).toUpperCase()}),e.jsxs(te,{variant:"outlined",sx:{p:1,flexGrow:1,bgcolor:"transparent"},children:[e.jsx(re,{fullWidth:!0,multiline:!0,rows:2,placeholder:"Type a message",sx:{px:1}}),e.jsxs(k,{direction:"row",alignItems:"center",children:[e.jsxs(k,{direction:"row",flexGrow:1,children:[e.jsx($,{children:e.jsx(j,{icon:"solar:gallery-add-bold"})}),e.jsx($,{children:e.jsx(j,{icon:"eva:attach-2-fill"})})]}),e.jsx(W,{variant:"contained",children:"Comment"})]})]})]})}const xe=64;function ia({assignee:n=[],open:a,onClose:s}){const[t,r]=c.useState(""),o=c.useCallback(i=>{r(i.target.value)},[]),d=la({inputData:le,query:t}),m=!d.length&&!!t;return e.jsxs(Dn,{fullWidth:!0,maxWidth:"xs",open:a,onClose:s,children:[e.jsxs(On,{sx:{pb:0},children:["Contacts ",e.jsxs(_,{component:"span",children:["(",le.length,")"]})]}),e.jsx(y,{sx:{px:3,py:2.5},children:e.jsx(oe,{fullWidth:!0,value:t,onChange:o,placeholder:"Search...",InputProps:{startAdornment:e.jsx(Fn,{position:"start",children:e.jsx(j,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})}),e.jsx(An,{sx:{p:0},children:m?e.jsx(In,{query:t,sx:{mt:3,mb:10}}):e.jsx(ye,{sx:{height:xe*6,px:2.5},children:e.jsx(y,{component:"ul",children:d.map(i=>{const l=n.map(x=>x.name).includes(i.name);return e.jsxs(y,{component:"li",sx:{gap:2,display:"flex",height:xe,alignItems:"center"},children:[e.jsx(H,{src:i.avatarUrl}),e.jsx(Ln,{primaryTypographyProps:{typography:"subtitle2",sx:{mb:.25}},secondaryTypographyProps:{typography:"caption"},primary:i.name,secondary:i.email}),e.jsx(W,{size:"small",color:l?"primary":"inherit",startIcon:e.jsx(j,{width:16,icon:l?"eva:checkmark-fill":"mingcute:add-line",sx:{mr:-.5}}),children:l?"Assigned":"Assign"})]},i.id)})})})})]})}function la({inputData:n,query:a}){return a&&(n=n.filter(s=>s.name.toLowerCase().indexOf(a.toLowerCase())!==-1||s.email.toLowerCase().indexOf(a.toLowerCase())!==-1)),n}const Z=["Complete project proposal","Conduct market research","Design user interface mockups","Develop backend api","Implement authentication system"],B=P("span")(({theme:n})=>({...n.typography.caption,width:100,flexShrink:0,color:n.vars.palette.text.secondary,fontWeight:n.typography.fontWeightSemiBold}));function ca({task:n,openDetails:a,onUpdateTask:s,onDeleteTask:t,onCloseDetails:r}){const o=bn("overview"),[d,m]=c.useState(n.priority),[i,l]=c.useState(n.name),[x,g]=c.useState(Z.slice(0,2)),f=M(),S=M(),[w,O]=c.useState(n.description),C=yn(ce(n.due[0]),ce(n.due[1])),E=c.useCallback(u=>{l(u.target.value)},[]),G=c.useCallback(u=>{try{u.key==="Enter"&&i&&s({...n,name:i})}catch(K){console.error(K)}},[s,n,i]),V=c.useCallback(u=>{O(u.target.value)},[]),h=c.useCallback(u=>{m(u)},[]),p=u=>{const K=x.includes(u)?x.filter(A=>A!==u):[...x,u];g(K)},T=e.jsx(aa,{liked:f.value,taskName:n.name,onLike:f.onToggle,onDelete:t,taskStatus:n.status,onCloseDetails:r}),v=e.jsx(jn,{value:o.value,onChange:o.onChange,variant:"fullWidth",slotProps:{tab:{px:0}},children:[{value:"overview",label:"Overview"},{value:"subTasks",label:"Subtasks"},{value:"comments",label:`Comments (${n.comments.length})`}].map(u=>e.jsx($n,{value:u.value,label:u.label},u.value))}),I=e.jsxs(y,{sx:{gap:3,display:"flex",flexDirection:"column"},children:[e.jsx(Oe,{placeholder:"Task name",value:i,onChange:E,onKeyUp:G,inputProps:{id:`input-task-${i}`}}),e.jsxs(y,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(B,{children:"Reporter"}),e.jsx(H,{alt:n.reporter.name,src:n.reporter.avatarUrl})]}),e.jsxs(y,{sx:{display:"flex"},children:[e.jsx(B,{sx:{height:40,lineHeight:"40px"},children:"Assignee"}),e.jsxs(y,{sx:{gap:1,display:"flex",flexWrap:"wrap"},children:[n.assignee.map(u=>e.jsx(H,{alt:u.name,src:u.avatarUrl},u.id)),e.jsx(J,{title:"Add assignee",children:e.jsx($,{onClick:S.onTrue,sx:{bgcolor:u=>L(u.vars.palette.grey["500Channel"],.08),border:u=>`dashed 1px ${u.vars.palette.divider}`},children:e.jsx(j,{icon:"mingcute:add-line"})})}),e.jsx(ia,{assignee:n.assignee,open:S.value,onClose:S.onFalse})]})]}),e.jsxs(y,{sx:{display:"flex"},children:[e.jsx(B,{sx:{height:24,lineHeight:"24px"},children:"Labels"}),!!n.labels.length&&e.jsx(y,{sx:{gap:1,display:"flex",flexWrap:"wrap"},children:n.labels.map(u=>e.jsx(Me,{color:"info",label:u,size:"small",variant:"soft"},u))})]}),e.jsxs(y,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(B,{children:" Due date "}),C.selected?e.jsx(W,{size:"small",onClick:C.onOpen,children:C.shortLabel}):e.jsx(J,{title:"Add due date",children:e.jsx($,{onClick:C.onOpen,sx:{bgcolor:u=>L(u.vars.palette.grey["500Channel"],.08),border:u=>`dashed 1px ${u.vars.palette.divider}`},children:e.jsx(j,{icon:"mingcute:add-line"})})}),e.jsx(Cn,{variant:"calendar",title:"Choose due date",startDate:C.startDate,endDate:C.endDate,onChangeStartDate:C.onChangeStartDate,onChangeEndDate:C.onChangeEndDate,open:C.open,onClose:C.onClose,selected:C.selected,error:C.error})]}),e.jsxs(y,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(B,{children:"Priority"}),e.jsx(sa,{priority:d,onChangePriority:h})]}),e.jsxs(y,{sx:{display:"flex"},children:[e.jsx(B,{children:" Description "}),e.jsx(oe,{fullWidth:!0,multiline:!0,size:"small",minRows:4,value:w,onChange:V,InputProps:{sx:{typography:"body2"}}})]}),e.jsxs(y,{sx:{display:"flex"},children:[e.jsx(B,{children:"Attachments"}),e.jsx(ta,{attachments:n.attachments})]})]}),F=e.jsxs(y,{sx:{gap:3,display:"flex",flexDirection:"column"},children:[e.jsxs("div",{children:[e.jsxs(_,{variant:"body2",sx:{mb:1},children:[x.length," of ",Z.length]}),e.jsx(ze,{variant:"determinate",value:x.length/Z.length*100})]}),e.jsx(Nn,{children:Z.map(u=>e.jsx(Ie,{control:e.jsx(En,{disableRipple:!0,name:u,checked:x.includes(u)}),label:u,onChange:()=>p(u)},u))}),e.jsx(W,{variant:"outlined",startIcon:e.jsx(j,{icon:"mingcute:add-line"}),sx:{alignSelf:"flex-start"},children:"Subtask"})]}),D=e.jsx(e.Fragment,{children:!!n.comments.length&&e.jsx(ra,{comments:n.comments})});return e.jsxs(He,{open:a,onClose:r,anchor:"right",slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:{xs:1,sm:480}}},children:[T,v,e.jsxs(ye,{fillContent:!0,sx:{py:3,px:2.5},children:[o.value==="overview"&&I,o.value==="subTasks"&&F,o.value==="comments"&&D]}),o.value==="comments"&&e.jsx(oa,{})]})}function da({task:n,disabled:a,columnId:s,sx:t}){const r=M(),{setNodeRef:o,listeners:d,isDragging:m,isSorting:i,transform:l,transition:x}=ve({id:n==null?void 0:n.id}),g=ua(),f=m&&!g,S=c.useCallback(async()=>{try{Gn(s,n.id),se.success("Delete success!",{position:"top-center"})}catch(O){console.error(O)}},[s,n.id]),w=c.useCallback(async O=>{try{Hn(s,O)}catch(C){console.error(C)}},[s]);return e.jsxs(e.Fragment,{children:[e.jsx(ie,{ref:a?void 0:o,task:n,onClick:r.onTrue,stateProps:{transform:l,listeners:d,transition:x,sorting:i,dragging:m,fadeIn:f},sx:{...r.value&&{[`& .${Te.root}`]:{opacity:.8}},...t}}),e.jsx(ca,{task:n,openDetails:r.value,onCloseDetails:r.onFalse,onUpdateTask:w,onDeleteTask:S})]})}function ua(){const[n,a]=c.useState(!1);return c.useEffect(()=>{const s=setTimeout(()=>a(!0),500);return()=>clearTimeout(s)},[]),n}function ma({sx:n,...a}){const[s,t]=c.useState(""),r=M(),o=c.useCallback(l=>{t(l.target.value)},[]),d=c.useCallback(async()=>{try{const l={id:ke(),name:s.trim()?s:"Untitled"};Un(l),t(""),r.onFalse()}catch(l){console.error(l)}},[s,r]),m=c.useCallback(l=>{l.key==="Enter"&&d()},[d]),i=c.useCallback(()=>{t(""),r.onFalse()},[r]);return e.jsxs(e.Fragment,{children:[e.jsx(y,{sx:{width:"var(--column-width)",flex:"0 0 auto",...n},...a,children:r.value?e.jsx(we,{onClickAway:i,children:e.jsx(oe,{autoFocus:!0,fullWidth:!0,placeholder:"Untitled",value:s,onChange:o,onKeyUp:m,helperText:"Press Enter to create the column.",sx:{[`& .${Y.input}`]:{typography:"h6"}}})}):e.jsx(W,{fullWidth:!0,size:"large",color:"inherit",variant:"outlined",startIcon:e.jsx(j,{icon:"mingcute:add-line",sx:{mr:-.5}}),onClick:r.onTrue,children:"Add column"})}),e.jsx(y,{sx:{width:"1px",flexShrink:0}})]})}function ha({amount:n=3,sx:a,...s}){return[...Array(n)].map((t,r)=>e.jsxs(te,{variant:"outlined",sx:{display:"flex",gap:"var(--item-gap)",flexDirection:"column",p:"var(--column-padding)",width:"var(--column-width)",borderRadius:"var(--column-radius)",...a},...s,children:[e.jsx(q,{sx:{pt:"75%",borderRadius:1.5}}),[0].includes(r)&&e.jsx(q,{sx:{pt:"50%",borderRadius:1.5}}),[0,1].includes(r)&&e.jsx(q,{sx:{pt:"25%",borderRadius:1.5}}),[0,1,2].includes(r)&&e.jsx(q,{sx:{pt:"25%",borderRadius:1.5}})]},r))}const xa={sideEffects:nn({styles:{active:{opacity:"0.5"}}})};function pa({columns:n,tasks:a,activeId:s,sx:t}){const r=n.map(i=>i.id),o=n.find(i=>i.id===s),m=Object.values(a).flat().find(i=>i.id===s);return e.jsx(Ge,{children:e.jsx(en,{adjustScale:!1,dropAnimation:xa,children:s?e.jsx(e.Fragment,{children:r.includes(s)?e.jsx(ga,{column:o,tasks:a[s],sx:t}):e.jsx(fa,{task:m,sx:t})}):null})})}function ga({column:n,tasks:a,sx:s}){return e.jsx(De,{slots:{header:e.jsx(Fe,{columnName:n.name,totalTasks:a.length}),main:a.map(t=>e.jsx(ie,{task:t},t.id))},stateProps:{dragOverlay:!0},sx:s})}function fa({task:n,sx:a}){return e.jsx(ie,{task:n,sx:a,stateProps:{dragOverlay:!0}})}const pe="placeholder",ge={"--item-gap":"16px","--item-radius":"12px","--column-gap":"24px","--column-width":"336px","--column-radius":"16px","--column-padding":"20px 16px 16px 16px"};function ba(){const{board:n,boardLoading:a,boardEmpty:s}=Kn(),[t,r]=c.useState(!0),o=c.useRef(!1),d=c.useRef(null),[m,i]=c.useState(null),l=n.columns.map(h=>h.id),x=m?l.includes(m):!1,g=an(ne(mn,{activationConstraint:{distance:5}}),ne(un,{activationConstraint:{distance:5}}),ne(dn,{coordinateGetter:Xn})),f=c.useCallback(h=>{var I;if(m&&m in n.tasks)return de({...h,droppableContainers:h.droppableContainers.filter(F=>F.id in n.tasks)});const p=sn(h),T=p.length>0?p:tn(h);let v=Ce(T,"id");if(v!=null){if(v in n.tasks){const F=n.tasks[v].map(D=>D.id);F.length>0&&(v=(I=de({...h,droppableContainers:h.droppableContainers.filter(D=>D.id!==v&&F.includes(D.id))})[0])==null?void 0:I.id)}return d.current=v,[{id:v}]}return o.current&&(d.current=m),d.current?[{id:d.current}]:[]},[m,n==null?void 0:n.tasks]),S=h=>h in n.tasks?h:Object.keys(n.tasks).find(p=>n.tasks[p].map(T=>T.id).includes(h));c.useEffect(()=>{requestAnimationFrame(()=>{o.current=!1})},[]);const w=({active:h})=>{i(h.id)},O=({active:h,over:p})=>{const T=p==null?void 0:p.id;if(T==null||h.id in n.tasks)return;const v=S(T),I=S(h.id);if(!(!v||!I)&&I!==v){const F=n.tasks[I].map(z=>z.id),D=n.tasks[v].map(z=>z.id),u=D.indexOf(T),K=F.indexOf(h.id);let A;if(T in n.tasks)A=D.length+1;else{const Le=p&&h.rect.current.translated&&h.rect.current.translated.top>p.rect.top+p.rect.height?1:0;A=u>=0?u+Le:D.length+1}o.current=!0;const Ae={...n.tasks,[I]:n.tasks[I].filter(z=>z.id!==h.id),[v]:[...n.tasks[v].slice(0,A),n.tasks[I][K],...n.tasks[v].slice(A,n.tasks[v].length)]};he(Ae)}},C=({active:h,over:p})=>{if(h.id in n.tasks&&(p!=null&&p.id)){const F=l.indexOf(h.id),D=l.indexOf(p.id),u=me(n.columns,F,D);Bn(u)}const T=S(h.id);if(!T){i(null);return}const v=p==null?void 0:p.id;if(v==null){i(null);return}const I=S(v);if(I){const F=n.tasks[T].map(A=>A.id),D=n.tasks[I].map(A=>A.id),u=F.indexOf(h.id),K=D.indexOf(v);if(u!==K){const A={...n.tasks,[I]:me(n.tasks[I],u,K)};he(A)}}i(null)},E=e.jsx(k,{direction:"row",alignItems:"flex-start",sx:{gap:"var(--column-gap)"},children:e.jsx(ha,{})}),G=e.jsx(hn,{filled:!0,sx:{py:10,maxHeight:{md:480}}}),V=e.jsxs(rn,{id:"dnd-kanban",sensors:g,collisionDetection:f,measuring:{droppable:{strategy:on.Always}},onDragStart:w,onDragOver:O,onDragEnd:C,children:[e.jsx(k,{sx:{flex:"1 1 auto",overflowX:"auto"},children:e.jsx(k,{sx:{pb:3,display:"unset",...t&&{minHeight:0,display:"flex",flex:"1 1 auto"}},children:e.jsx(k,{direction:"row",sx:{gap:"var(--column-gap)",...t&&{minHeight:0,flex:"1 1 auto",[`& .${b.columnList}`]:{...Ve,flex:"1 1 auto"}}},children:e.jsxs(ue,{items:[...l,pe],strategy:ln,children:[n==null?void 0:n.columns.map(h=>e.jsx(Zn,{column:h,tasks:n.tasks[h.id],children:e.jsx(ue,{items:n.tasks[h.id],strategy:cn,children:n.tasks[h.id].map(p=>e.jsx(da,{task:p,columnId:h.id,disabled:x},p.id))})},h.id)),e.jsx(ma,{id:pe})]})})})}),e.jsx(pa,{columns:n==null?void 0:n.columns,tasks:n==null?void 0:n.tasks,activeId:m,sx:ge})]});return e.jsxs(Xe,{maxWidth:!1,sx:{...ge,pb:0,pl:{sm:3},pr:{sm:0},flex:"1 1 0",display:"flex",overflow:"hidden",flexDirection:"column"},children:[e.jsxs(k,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{pr:{sm:3},mb:{xs:3,md:5}},children:[e.jsx(_,{variant:"h4",children:"Kanban"}),e.jsx(Ie,{label:"Column fixed",labelPlacement:"start",control:e.jsx(Ye,{checked:t,onChange:h=>{r(h.target.checked)},inputProps:{id:"column-fixed-switch"}})})]}),a?E:e.jsx(e.Fragment,{children:s?G:V})]})}const ja={title:`Kanban | Dashboard - ${qe.site.name}`};function os(){return e.jsxs(e.Fragment,{children:[e.jsx(Je,{children:e.jsxs("title",{children:[" ",ja.title]})}),e.jsx(ba,{})]})}export{os as default};
