import{aI as Y,a as r,b as E,j as e,_ as F,d as A,e as B,s as ee,Z as te,aJ as ae,aK as Q,aL as se,aM as oe,aN as re,aO as le,aP as ne,a1 as T,w as R,F as O,aQ as ie,aR as ce,aS as de,O as ue,K as he,an as pe,aT as G,X as C,aG as me,$ as L,Q as be,I as M,aU as ge,aV as fe,ao as xe,H as Ce,J as we}from"./index-CWahQ5ZS.js";import"./product-new-edit-form-DApSWi5g.js";import{E as D}from"./empty-content-CIXLGBzD.js";import{u as z,g as _,a as je,b as ye,i as N,c as Se,D as ke,d as Me,C as Fe,G as v}from"./confirm-dialog-D8912JMu.js";import{C as Re}from"./custom-breadcrumbs-CTZqJBNk.js";import{M as V}from"./MenuItem-DtpA0HbG.js";import{C as ve}from"./Checkbox-CcYt3HFR.js";import{f as Pe}from"./format-number-jQTf3B9V.js";import{b as Ie}from"./form-provider-CaIsVnSA.js";import{L as Te}from"./Link-OvF8PdYx.js";import{C as Ge}from"./Card-C6GOi25m.js";import"./index-CbZhzOjM.js";import"./image-Ds2WO9mA.js";import"./CardHeader-DunmSz8L.js";import"./index-3-9U5rMU.js";import"./InputAdornment-BL3eVklr.js";import"./LastPage-C1-szZ7l.js";import"./TableCell-DgfcWENc.js";import"./FormControlLabel-Cfv7DgQP.js";import"./index-DPBAm0ef.js";const Le=["className","children"],De=t=>{const{classes:s}=t;return B({root:["toolbarContainer"]},_,s)},Ne=Y("div",{name:"MuiDataGrid",slot:"ToolbarContainer",overridesResolver:(t,s)=>s.toolbarContainer})(({theme:t})=>({display:"flex",alignItems:"center",flexWrap:"wrap",gap:t.spacing(1),padding:t.spacing(.5,.5,0)})),Ve=r.forwardRef(function(s,o){const{className:h,children:n}=s,c=E(s,Le),d=z(),l=De(d);return n?e.jsx(Ne,F({ref:o,className:A(h,l.root),ownerState:d},c,{children:n})):null}),Ee=["quickFilterParser","quickFilterFormatter","debounceMs","className"],Ae=t=>{const{classes:s}=t;return B({root:["toolbarQuickFilter"]},_,s)},Be=ee(te,{name:"MuiDataGrid",slot:"ToolbarQuickFilter",overridesResolver:(t,s)=>s.toolbarQuickFilter})(({theme:t})=>({width:"auto",paddingBottom:t.spacing(.5),"& input":{marginLeft:t.spacing(.5)},"& .MuiInput-underline:before":{borderBottom:`1px solid ${(t.vars||t).palette.divider}`},'& input[type="search"]::-webkit-search-decoration,\n  & input[type="search"]::-webkit-search-cancel-button,\n  & input[type="search"]::-webkit-search-results-button,\n  & input[type="search"]::-webkit-search-results-decoration':{display:"none"}})),Qe=t=>t.split(" ").filter(s=>s!==""),Oe=t=>t.join(" ");function ze(t){var S,k;const s=je(),o=z(),h=Ae(o),n=ye(s,Se),{quickFilterParser:c=Qe,quickFilterFormatter:d=Oe,debounceMs:l=o.filterDebounceMs,className:i}=t,u=E(t,Ee),[w,f]=r.useState(()=>d(n??[])),x=r.useRef(n);r.useEffect(()=>{N(x.current,n)||(x.current=n,f(b=>N(c(b),n)?b:d(n??[])))},[n,d,c]);const m=r.useCallback(b=>{const p=c(b);x.current=p,s.current.setQuickFilterValues(p)},[s,c]),j=r.useMemo(()=>ae(m,l),[m,l]),g=r.useCallback(b=>{const p=b.target.value;f(p),j(p)},[j]),y=r.useCallback(()=>{f(""),m("")},[m]);return e.jsx(Be,F({as:o.slots.baseTextField,ownerState:o,variant:"standard",value:w,onChange:g,className:A(i,h.root),placeholder:s.current.getLocaleText("toolbarQuickFilterPlaceholder"),"aria-label":s.current.getLocaleText("toolbarQuickFilterLabel"),type:"search"},u,{InputProps:F({startAdornment:e.jsx(o.slots.quickFilterIcon,{fontSize:"small"}),endAdornment:e.jsx(o.slots.baseIconButton,F({"aria-label":s.current.getLocaleText("toolbarQuickFilterDeleteIconLabel"),size:"small",sx:{visibility:w?"visible":"hidden"},onClick:y},(S=o.slotProps)==null?void 0:S.baseIconButton,{children:e.jsx(o.slots.quickFilterClearIcon,{fontSize:"small"})}))},u.InputProps)},(k=o.slotProps)==null?void 0:k.baseTextField))}function _e({filters:t,options:s}){const o=Q({categories:t.state.categories}),h=r.useCallback(l=>{const{target:{value:i}}=l;o.setState({categories:typeof i=="string"?i.split(","):i})},[o]),n=r.useCallback(()=>{t.setState({categories:o.state.categories})},[t,o.state.categories]),c=r.useCallback(l=>()=>{const i=o.state.categories.indexOf(l),u=[...o.state.categories];i===-1?u.push(l):u.splice(i,1),o.setState({categories:u})},[o]),d=s.categories.reduce((l,i)=>(l.push(e.jsx(se,{children:i.name},i.name)),i.categories.forEach(u=>{l.push(e.jsxs(V,{value:u.name,onClick:c(u.name),children:[e.jsx(ve,{disableRipple:!0,size:"small",checked:o.state.categories.includes(u.name)}),u.name]},u.name))}),l),[]);return e.jsxs(oe,{sx:{flexShrink:0,width:{xs:1,md:200}},children:[e.jsx(re,{htmlFor:"product-filter-title-select-label",children:"Loại sản phẩm"}),e.jsxs(le,{multiple:!0,value:o.state.categories,onChange:h,onClose:n,input:e.jsx(ne,{label:"Loại sản phẩm"}),renderValue:l=>l.join(", "),inputProps:{id:"product-filter-title-select-label"},sx:{textTransform:"capitalize"},children:[d,e.jsx(V,{onClick:n,sx:{justifyContent:"center",fontWeight:l=>l.typography.button,border:l=>`solid 1px ${T(l.vars.palette.grey["500Channel"],.16)}`,bgcolor:l=>T(l.vars.palette.grey["500Channel"],.08)},children:"Áp dụng"})]})]})}function $e({params:t}){return t.row.slug}function qe({params:t}){return e.jsx(R,{sx:{display:"inline-block",padding:"2px 8px",borderRadius:"8px",backgroundColor:"primary.main",color:"white",textAlign:"center",minWidth:"24px"},children:t.row.priority})}function Ue({params:t}){return Pe(t.row.price)}function He({params:t}){return`${t.row.salePercent}%`}function We({params:t}){return t.row.createBy.email}function Xe({params:t}){return e.jsxs(O,{spacing:.5,children:[e.jsx(R,{component:"span",children:ie(t.row.createdAt)}),e.jsx(R,{component:"span",sx:{typography:"caption",color:"text.secondary"},children:ce(t.row.createdAt)})]})}function Je({params:t,onViewRow:s}){return e.jsxs(O,{direction:"row",alignItems:"center",sx:{py:2,width:1},children:[e.jsx(de,{alt:t.row.title,src:t.row.thumbnail,variant:"rounded",sx:{width:64,height:64,mr:2}}),e.jsx(Ie,{disableTypography:!0,primary:e.jsx(Te,{noWrap:!0,color:"inherit",variant:"subtitle2",onClick:s,sx:{cursor:"pointer"},children:t.row.title}),secondary:e.jsx(R,{component:"div",sx:{typography:"body2",color:"text.disabled"},children:t.row.category.name}),sx:{display:"flex",flexDirection:"column"}})]})}const Ke={category:!1},Ze=["category","actions"];function Ye(){const t=ue(),s=he(),[o,h]=r.useState(10),[n,c]=r.useState(0),[d,l]=r.useState(""),[i,u]=r.useState([]),{data:w,productsLoading:f,productsMutate:x}=pe(o,n,d,i),{products:m,paginate:j}=w,g=Q({categories:[]});r.useEffect(()=>{h(o),c(n),u(g.state.categories)},[o,n,g]);const y=a=>{l(a.target.value),c(0)},S=r.useCallback(()=>e.jsx(et,{filters:g,handleSearchChange:y,search:d}),[y,d,g]),[k,b]=r.useState([]),[p,$]=r.useState([]),[q,U]=r.useState(null),[H,W]=r.useState(Ke);r.useEffect(()=>{m.length&&b(m)},[m]);const X=async a=>{await G(a),x(),xe.success("Xóa thành công!")},J=r.useCallback(async()=>{await Promise.all(p.map(a=>G(a.toString())))},[p]),K=r.useCallback(a=>{s.push(C.dashboard.product.edit(a))},[s]),P=r.useCallback(a=>{s.push(C.dashboard.product.details(a))},[s]),I=[{field:"category",headerName:"Category",filterable:!1},{field:"id",headerName:"Mã sản phẩm",width:160,sortable:!1,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx($e,{params:a})},{field:"name",headerName:"Sản phẩm",flex:1,minWidth:160,hideable:!1,sortable:!1,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Je,{params:a,onViewRow:()=>P(a.row.slug)})},{field:"priority",headerName:"Độ ưu tiên",headerAlign:"center",width:100,editable:!0,align:"center",sortable:!1,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(qe,{params:a})},{field:"price",headerName:"Giá",width:140,editable:!0,sortable:!1,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Ue,{params:a})},{field:"salePercent",headerName:"Giảm giá",headerAlign:"center",align:"center",width:100,editable:!0,sortable:!1,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(He,{params:a})},{field:"createdAt",headerName:"Ngày tạo",width:160,sortable:!1,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(Xe,{params:a})},{field:"createBy",headerName:"Tạo bởi",width:110,sortable:!1,filterable:!1,disableColumnMenu:!0,renderCell:a=>e.jsx(We,{params:a})},{type:"actions",field:"actions",headerName:" ",align:"right",headerAlign:"right",width:80,sortable:!1,filterable:!1,disableColumnMenu:!0,getActions:a=>[e.jsx(v,{showInMenu:!0,icon:e.jsx(M,{icon:"solar:eye-bold"}),label:"Xem",onClick:()=>P(a.row.slug)}),e.jsx(v,{showInMenu:!0,icon:e.jsx(M,{icon:"solar:pen-bold"}),label:"Sửa",onClick:()=>K(a.row.slug)}),e.jsx(v,{showInMenu:!0,icon:e.jsx(M,{icon:"solar:trash-bin-trash-bold"}),label:"Xóa",onClick:()=>{X(a.row.id)},sx:{color:"error.main"}})]}],Z=()=>I.filter(a=>!Ze.includes(a.field)).map(a=>a.field);return e.jsxs(e.Fragment,{children:[e.jsxs(me,{sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(Re,{heading:"Danh sách",links:[{name:"Quản trị",href:C.dashboard.root},{name:"Sản phẩm",href:C.dashboard.product.root},{name:"Danh sách"}],action:e.jsx(L,{component:be,href:C.dashboard.product.new,variant:"contained",startIcon:e.jsx(M,{icon:"mingcute:add-line"}),children:"Thêm sản phẩm"}),sx:{mb:{xs:3,md:5}}}),e.jsx(Ge,{sx:{flexGrow:{md:1},display:{md:"flex"},height:{xs:800,md:2},flexDirection:{md:"column"}},children:e.jsx(ke,{disableRowSelectionOnClick:!0,rows:k,columns:I,loading:f,getRowHeight:()=>"auto",pageSizeOptions:[5,10,25],initialState:{pagination:{paginationModel:{pageSize:o,page:n}}},rowCount:j.totalCount,paginationMode:"server",filterMode:"server",onPaginationModelChange:a=>{h(a.pageSize),c(a.page)},onRowSelectionModelChange:a=>$(a),columnVisibilityModel:H,onColumnVisibilityModelChange:a=>W(a),slots:{toolbar:S,noRowsOverlay:()=>e.jsx(D,{}),noResultsOverlay:()=>e.jsx(D,{title:"No results found"})},slotProps:{panel:{anchorEl:q},toolbar:{setFilterButtonEl:U},columnsManagement:{getTogglableColumns:Z}},sx:{[`& .${Me.cell}`]:{alignItems:"center",display:"inline-flex"}}})})]}),e.jsx(Fe,{open:t.value,onClose:t.onFalse,title:"Delete",content:e.jsxs(e.Fragment,{children:["Bạn chắc chắn muốn xóa ",e.jsxs("strong",{children:[" ",p.length," "]})," sản phẩm?"]}),action:e.jsx(L,{variant:"contained",color:"error",onClick:()=>{J(),t.onFalse()},children:"Xóa"})})]})}function et({handleSearchChange:t,search:s,filters:o}){const[h,n]=r.useState(s),c=r.useMemo(()=>ge.debounce(i=>t(i),500),[t]),d=i=>{n(i.target.value),c(i)};r.useEffect(()=>{n(s)},[s]);const{categories:l}=fe();return e.jsxs(Ve,{children:[e.jsx(_e,{filters:o,options:{categories:l}}),e.jsx(ze,{onChange:d,value:h,placeholder:"Mã hoặc tên sản phẩm..."})]})}const tt={title:`Sản phẩm | ${we.site.name}`};function yt(){return e.jsxs(e.Fragment,{children:[e.jsx(Ce,{children:e.jsxs("title",{children:[" ",tt.title]})}),e.jsx(Ye,{})]})}export{yt as default};
