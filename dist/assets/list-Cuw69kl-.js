import{aX as U,j as e,h as v,I as x,B as j,dc as X,q as _,w as y,t as O,ea as $,cw as N,aZ as V,n as z,r as c,ad as L,a$ as H,eD as Y,au as M,eE as J,eF as Q,d8 as I,T as C,f as ee,cx as B,ap as te,b3 as k,cy as se,cz as ae,p as ne,dK as G,cI as oe,eZ as W,e_ as re,eW as ie,e$ as le,cY as ce,eG as E,ec as de,H as pe,l as he}from"./index-CZQdhxL6.js";import{E as me}from"./empty-content-CNoNRi_C.js";import{C as xe}from"./custom-breadcrumbs-Cstz3_WJ.js";import{a as A}from"./format-number-BMTKi65b.js";import{I as P}from"./image-BKqVmPzF.js";import{L as ue}from"./ListItemText-Cr03FIqH.js";import{L as je}from"./Link-aHbKcscn.js";import{C as ge}from"./Card-BpNMtBWE.js";import{M as T}from"./MenuItem-B-kec-ET.js";import{P as be,p as ve}from"./Pagination-Bk1AVDVq.js";import{S as ye}from"./search-not-found-DUPrzHz6.js";import{I as fe}from"./InputAdornment-FYGjj27N.js";import{C as Ce}from"./country-select-DInEscmA.js";import{D as q}from"./DatePicker-DnV5-WsQ.js";import{F as Se}from"./FormControlLabel-BkPFkiPo.js";import{C as ke}from"./Checkbox-vPWnpj5r.js";import{F as De,a as D,c as w}from"./filters-result-BjhVJUlj.js";import"./tour-new-edit-form-BCYYEHJ3.js";import"./label-VukvCSVc.js";import"./html-to-markdown-DZkUaXsX.js";import"./listItemTextClasses-tNQx_Nyt.js";import"./LastPage-BXs-7qE5.js";import"./countries-DSLisFCy.js";import"./index-BlO45MYk.js";import"./visuallyHidden-Dan1xhjv.js";import"./DialogActions-q6AF7Mz6.js";import"./ListItem-B0RV7hht.js";import"./listItemButtonClasses-DXIYlEZ6.js";import"./dialogTitleClasses-CEl360C-.js";import"./DialogContent-DclWW8HV.js";import"./form-provider-CgY9D6Kg.js";import"./Rating-CUg9OHpq.js";import"./editor-CDG2HKGW.js";import"./index-SBExoyVP.js";import"./Slider-Cgtky4hB.js";import"./RadioGroup-Cdn6J0S9.js";import"./FormGroup-BHWDss9q.js";import"./upload-Cc3l3Jk3.js";import"./preview-multi-file-DA87ns5L.js";import"./file-thumbnail-DwL3Xnqg.js";import"./upload-box-BxodnsWX.js";import"./upload-avatar-B-zuBAMk.js";import"./MobileDateTimePicker-8HOBSqCX.js";import"./Tabs-B1eQZdBL.js";import"./KeyboardArrowRight-CiRDKZM6.js";import"./schema-helper-B-83MGJ7.js";import"./CardHeader-OkCeJUez.js";import"./LoadingButton-CHo-zp-G.js";import"./CircularProgress-BNfym32c.js";function we({tour:t,onView:d,onEdit:p,onDelete:s}){const n=U(),r=e.jsxs(v,{direction:"row",alignItems:"center",sx:{top:8,right:8,zIndex:9,borderRadius:1,position:"absolute",p:"2px 6px 2px 4px",typography:"subtitle2",bgcolor:"warning.lighter"},children:[e.jsx(x,{icon:"eva:star-fill",sx:{color:"warning.main",mr:.25}})," ",t.ratingNumber]}),o=e.jsxs(v,{direction:"row",alignItems:"center",sx:{top:8,left:8,zIndex:9,borderRadius:1,bgcolor:"grey.800",position:"absolute",p:"2px 6px 2px 4px",color:"common.white",typography:"subtitle2"},children:[!!t.priceSale&&e.jsx(j,{component:"span",sx:{color:"grey.500",mr:.25,textDecoration:"line-through"},children:A(t.priceSale)}),A(t.price)]}),a=e.jsxs(j,{gap:.5,display:"flex",sx:{p:1},children:[e.jsxs(j,{flexGrow:1,sx:{position:"relative"},children:[o,r,e.jsx(P,{alt:t.images[0],src:t.images[0],sx:{width:1,height:164,borderRadius:1}})]}),e.jsxs(j,{gap:.5,display:"flex",flexDirection:"column",children:[e.jsx(P,{alt:t.images[1],src:t.images[1],ratio:"1/1",sx:{borderRadius:1,width:80,height:80}}),e.jsx(P,{alt:t.images[2],src:t.images[2],ratio:"1/1",sx:{borderRadius:1,width:80,height:80}})]})]}),h=e.jsx(ue,{sx:{p:l=>l.spacing(2.5,2.5,2,2.5)},primary:`Posted date: ${X(t.createdAt)}`,secondary:e.jsx(je,{component:_,href:y.dashboard.tour.details(t.id),color:"inherit",children:t.name}),primaryTypographyProps:{typography:"caption",color:"text.disabled"},secondaryTypographyProps:{mt:1,noWrap:!0,component:"span",color:"text.primary",typography:"subtitle1"}}),m=e.jsxs(v,{spacing:1.5,sx:{position:"relative",p:l=>l.spacing(0,2.5,2.5,2.5)},children:[e.jsx(O,{onClick:n.onOpen,sx:{position:"absolute",bottom:20,right:8},children:e.jsx(x,{icon:"eva:more-vertical-fill"})}),[{icon:e.jsx(x,{icon:"mingcute:location-fill",sx:{color:"error.main"}}),label:t.destination},{icon:e.jsx(x,{icon:"solar:clock-circle-bold",sx:{color:"info.main"}}),label:$(t.available.startDate,t.available.endDate)},{icon:e.jsx(x,{icon:"solar:users-group-rounded-bold",sx:{color:"primary.main"}}),label:`${t.bookers.length} Booked`}].map(l=>e.jsxs(v,{spacing:1,direction:"row",alignItems:"center",sx:{typography:"body2"},children:[l.icon,l.label]},l.label))]});return e.jsxs(e.Fragment,{children:[e.jsxs(ge,{children:[a,h,m]}),e.jsx(N,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs(V,{children:[e.jsxs(T,{onClick:()=>{n.onClose(),d()},children:[e.jsx(x,{icon:"solar:eye-bold"}),"View"]}),e.jsxs(T,{onClick:()=>{n.onClose(),p()},children:[e.jsx(x,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(T,{onClick:()=>{n.onClose(),s()},sx:{color:"error.main"},children:[e.jsx(x,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})})]})}function Te({tours:t}){const d=z(),p=c.useCallback(r=>{d.push(y.dashboard.tour.details(r))},[d]),s=c.useCallback(r=>{d.push(y.dashboard.tour.edit(r))},[d]),n=c.useCallback(r=>{console.info("DELETE",r)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(j,{gap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"},children:t.map(r=>e.jsx(we,{tour:r,onView:()=>p(r.id),onEdit:()=>s(r.id),onDelete:()=>n(r.id)},r.id))}),t.length>8&&e.jsx(be,{count:8,sx:{mt:{xs:5,md:8},[`& .${ve.ul}`]:{justifyContent:"center"}}})]})}function Ie({sort:t,onSort:d,sortOptions:p}){const s=U();return e.jsxs(e.Fragment,{children:[e.jsxs(L,{disableRipple:!0,color:"inherit",onClick:s.onOpen,endIcon:e.jsx(x,{icon:s.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill"}),sx:{fontWeight:"fontWeightSemiBold"},children:["Sort by:",e.jsx(j,{component:"span",sx:{ml:.5,fontWeight:"fontWeightBold",textTransform:"capitalize"},children:t})]}),e.jsx(N,{open:s.open,anchorEl:s.anchorEl,onClose:s.onClose,children:e.jsx(V,{children:p.map(n=>e.jsx(T,{selected:n.value===t,onClick:()=>{s.onClose(),d(n.value)},children:n.label},n.value))})})]})}function Fe({search:t,onSearch:d}){const p=z(),{state:s}=t,n=o=>{p.push(y.dashboard.tour.details(o))},r=o=>{if(s.query&&o.key==="Enter"){const a=s.results.filter(h=>h.name===s.query)[0];n(a.id)}};return e.jsx(H,{sx:{width:{xs:1,sm:260}},autoHighlight:!0,popupIcon:null,options:s.results,onInputChange:(o,a)=>d(a),getOptionLabel:o=>o.name,noOptionsText:e.jsx(ye,{query:s.query}),isOptionEqualToValue:(o,a)=>o.id===a.id,slotProps:{popper:{placement:"bottom-start",sx:{minWidth:320}},paper:{sx:{[` .${Y.option}`]:{pl:.75}}}},renderInput:o=>e.jsx(M,{...o,placeholder:"Search...",onKeyUp:r,InputProps:{...o.InputProps,startAdornment:e.jsx(fe,{position:"start",children:e.jsx(x,{icon:"eva:search-fill",sx:{ml:1,color:"text.disabled"}})})}}),renderOption:(o,a,{inputValue:h})=>{const m=J(a.name,h),l=Q(a.name,m);return c.createElement(j,{component:"li",...o,onClick:()=>n(a.id),key:a.id},e.jsx(I,{alt:a.name,src:a.images[0],variant:"rounded",sx:{mr:1.5,width:48,height:48,flexShrink:0,borderRadius:1}},a.id),e.jsx("div",{children:l.map((g,S)=>e.jsx(C,{component:"span",color:g.highlight?"primary":"textPrimary",sx:{typography:"body2",fontWeight:g.highlight?"fontWeightSemiBold":"fontWeightMedium"},children:g.text},S))},h))}})}function Re({open:t,onOpen:d,onClose:p,filters:s,options:n,canReset:r,dateError:o}){const a=c.useCallback(i=>{const u=s.state.services.includes(i)?s.state.services.filter(f=>f!==i):[...s.state.services,i];s.setState({services:u})},[s]),h=c.useCallback(i=>{s.setState({startDate:i})},[s]),m=c.useCallback(i=>{s.setState({endDate:i})},[s]),l=c.useCallback(i=>{s.setState({destination:i})},[s]),g=c.useCallback(i=>{s.setState({tourGuides:i})},[s]),S=e.jsxs(e.Fragment,{children:[e.jsxs(j,{display:"flex",alignItems:"center",sx:{py:2,pr:1,pl:2.5},children:[e.jsx(C,{variant:"h6",sx:{flexGrow:1},children:"Filters"}),e.jsx(ee,{title:"Reset",children:e.jsx(O,{onClick:s.onResetState,children:e.jsx(B,{color:"error",variant:"dot",invisible:!r,children:e.jsx(x,{icon:"solar:restart-bold"})})})}),e.jsx(O,{onClick:p,children:e.jsx(x,{icon:"mingcute:close-line"})})]}),e.jsx(te,{sx:{borderStyle:"dashed"}})]}),b=e.jsxs(j,{display:"flex",flexDirection:"column",children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1.5},children:"Durations"}),e.jsx(q,{label:"Start date",value:s.state.startDate,onChange:h,sx:{mb:2.5}}),e.jsx(q,{label:"End date",value:s.state.endDate,onChange:m,slotProps:{textField:{error:o,helperText:o?"End date must be later than start date":null}}})]}),F=e.jsxs(j,{display:"flex",flexDirection:"column",children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1.5},children:"Destination"}),e.jsx(Ce,{id:"multiple-destinations",multiple:!0,fullWidth:!0,placeholder:s.state.destination.length?"+ Destination":"Select Destination",value:s.state.destination,onChange:(i,u)=>l(u)})]}),R=e.jsxs(j,{display:"flex",flexDirection:"column",children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1.5},children:"Tour guide"}),e.jsx(H,{multiple:!0,disableCloseOnSelect:!0,options:n.tourGuides,value:s.state.tourGuides,onChange:(i,u)=>g(u),getOptionLabel:i=>i.name,renderInput:i=>e.jsx(M,{placeholder:"Select Tour Guides",...i}),renderOption:(i,u)=>c.createElement("li",{...i,key:u.id},e.jsx(I,{alt:u.avatarUrl,src:u.avatarUrl,sx:{mr:1,width:24,height:24,flexShrink:0}},u.id),u.name),renderTags:(i,u)=>i.map((f,Z)=>c.createElement(k,{...u({index:Z}),key:f.id,size:"small",variant:"soft",label:f.name,avatar:e.jsx(I,{alt:f.name,src:f.avatarUrl})}))})]}),K=e.jsxs(j,{display:"flex",flexDirection:"column",children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1},children:"Services"}),n.services.map(i=>e.jsx(Se,{control:e.jsx(ke,{checked:s.state.services.includes(i),onClick:()=>a(i)}),label:i},i))]});return e.jsxs(e.Fragment,{children:[e.jsx(L,{disableRipple:!0,color:"inherit",endIcon:e.jsx(B,{color:"error",variant:"dot",invisible:!r,children:e.jsx(x,{icon:"ic:round-filter-list"})}),onClick:d,children:"Filters"}),e.jsxs(se,{anchor:"right",open:t,onClose:p,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:320}},children:[S,e.jsx(ae,{sx:{px:2.5,py:3},children:e.jsxs(v,{spacing:3,children:[b,F,R,K]})})]})]})}function Ee({filters:t,totalResults:d,sx:p}){const s=c.useCallback(a=>{const h=t.state.services.filter(m=>m!==a);t.setState({services:h})},[t]),n=c.useCallback(()=>{t.setState({startDate:null,endDate:null})},[t]),r=c.useCallback(a=>{const h=t.state.tourGuides.filter(m=>m.name!==a.name);t.setState({tourGuides:h})},[t]),o=c.useCallback(a=>{const h=t.state.destination.filter(m=>m!==a);t.setState({destination:h})},[t]);return e.jsxs(De,{totalResults:d,onReset:t.onResetState,sx:p,children:[e.jsx(D,{label:"Available:",isShow:!!(t.state.startDate&&t.state.endDate),children:e.jsx(k,{...w,label:$(t.state.startDate,t.state.endDate),onDelete:n})}),e.jsx(D,{label:"Services:",isShow:!!t.state.services.length,children:t.state.services.map(a=>c.createElement(k,{...w,key:a,label:a,onDelete:()=>s(a)}))}),e.jsx(D,{label:"Tour guide:",isShow:!!t.state.tourGuides.length,children:t.state.tourGuides.map(a=>c.createElement(k,{...w,key:a.id,avatar:e.jsx(I,{alt:a.name,src:a.avatarUrl}),label:a.name,onDelete:()=>r(a)}))}),e.jsx(D,{label:"Destination:",isShow:!!t.state.destination.length,children:t.state.destination.map(a=>c.createElement(k,{...w,key:a,label:a,onDelete:()=>o(a)}))})]})}function Pe(){const t=ne(),[d,p]=c.useState("latest"),s=G({query:"",results:[]}),n=G({destination:[],tourGuides:[],services:[],startDate:null,endDate:null}),r=oe(n.state.startDate,n.state.endDate),o=Oe({inputData:W,filters:n.state,sortBy:d,dateError:r}),a=n.state.destination.length>0||n.state.tourGuides.length>0||n.state.services.length>0||!!n.state.startDate&&!!n.state.endDate,h=!o.length&&a,m=c.useCallback(b=>{p(b)},[]),l=c.useCallback(b=>{if(s.setState({query:b}),b){const F=W.filter(R=>R.name.toLowerCase().indexOf(s.state.query.toLowerCase())!==-1);s.setState({results:F})}},[s]),g=e.jsxs(v,{spacing:3,justifyContent:"space-between",alignItems:{xs:"flex-end",sm:"center"},direction:{xs:"column",sm:"row"},children:[e.jsx(Fe,{search:s,onSearch:l}),e.jsxs(v,{direction:"row",spacing:1,flexShrink:0,children:[e.jsx(Re,{filters:n,canReset:a,dateError:r,open:t.value,onOpen:t.onTrue,onClose:t.onFalse,options:{tourGuides:re,services:ie.map(b=>b.label)}}),e.jsx(Ie,{sort:d,onSort:m,sortOptions:le})]})]}),S=e.jsx(Ee,{filters:n,totalResults:o.length});return e.jsxs(ce,{children:[e.jsx(xe,{heading:"List",links:[{name:"Dashboard",href:y.dashboard.root},{name:"Tour",href:y.dashboard.tour.root},{name:"List"}],action:e.jsx(L,{component:_,href:y.dashboard.tour.new,variant:"contained",startIcon:e.jsx(x,{icon:"mingcute:add-line"}),children:"New Tour"}),sx:{mb:{xs:3,md:5}}}),e.jsxs(v,{spacing:2.5,sx:{mb:{xs:3,md:5}},children:[g,a&&S]}),h&&e.jsx(me,{filled:!0,sx:{py:10}}),e.jsx(Te,{tours:o})]})}const Oe=({inputData:t,filters:d,sortBy:p,dateError:s})=>{const{services:n,destination:r,startDate:o,endDate:a,tourGuides:h}=d,m=h.map(l=>l.id);return p==="latest"&&(t=E(t,["createdAt"],["desc"])),p==="oldest"&&(t=E(t,["createdAt"],["asc"])),p==="popular"&&(t=E(t,["totalViews"],["desc"])),r.length&&(t=t.filter(l=>r.includes(l.destination))),m.length&&(t=t.filter(l=>l.tourGuides.some(g=>m.includes(g.id)))),n.length&&(t=t.filter(l=>l.services.some(g=>n.includes(g)))),s||o&&a&&(t=t.filter(l=>de(o,l.available.startDate,l.available.endDate))),t},Le={title:`Tour list | Dashboard - ${he.site.name}`};function Rt(){return e.jsxs(e.Fragment,{children:[e.jsx(pe,{children:e.jsxs("title",{children:[" ",Le.title]})}),e.jsx(Pe,{})]})}export{Rt as default};
